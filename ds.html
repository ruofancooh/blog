<!DOCTYPE html>

<html lang="zh-CN">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width" name="viewport"/>
<meta content="#222" name="theme-color"/><meta content="Hexo 6.3.0" name="generator"/>
<link href="/blog/css/main.css" rel="stylesheet"/>
<link crossorigin="anonymous" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" rel="stylesheet"/>
<script class="next-config" data-name="main" type="application/json">{"hostname":"hrfis.me","root":"/blog/","images":"/blog/images","scheme":"Gemini","darkmode":false,"version":"8.16.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"flat"},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":true,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":false,"async":true,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","sidebar":"fadeInLeft"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/blog/js/config.js"></script>
<meta content="起因是两年前，《数据结构》及格了；《离散数学》及格了；《线性代数》在第四次及格了；《算法》也在第二次及格了。这四门课统称四小拦路蚂蚁。可以说是什么都及格了，太不拉胯了。
 和写算法代码相比，写论文综述有意思、简单多了。因为你不只需要明白道理，还需要把它实现出来。当然这同时指的是前两件事。" name="description"/>
<meta content="article" property="og:type"/>
<meta content="我就是学得会算法" property="og:title"/>
<meta content="https://hrfis.me/blog/ds.html" property="og:url"/>
<meta content="若凡的笔记" property="og:site_name"/>
<meta content="起因是两年前，《数据结构》及格了；《离散数学》及格了；《线性代数》在第四次及格了；《算法》也在第二次及格了。这四门课统称四小拦路蚂蚁。可以说是什么都及格了，太不拉胯了。
 和写算法代码相比，写论文综述有意思、简单多了。因为你不只需要明白道理，还需要把它实现出来。当然这同时指的是前两件事。" property="og:description"/>
<meta content="zh_CN" property="og:locale"/>
<meta content="2024-05-20T16:00:00.000Z" property="article:published_time"/>
<meta content="2024-06-03T12:41:19.382Z" property="article:modified_time"/>
<meta content="Ruofan" property="article:author"/>
<meta content="summary" name="twitter:card"/>
<link href="https://hrfis.me/blog/ds" rel="canonical"/>
<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://hrfis.me/blog/ds.html","path":"/ds.html","title":"我就是学得会算法"}</script>
<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>我就是学得会算法 | 若凡的笔记</title>
<noscript>
<link href="/blog/css/noscript.css" rel="stylesheet"/>
</noscript>
</head>
<body itemscope="" itemtype="http://schema.org/WebPage">
<div class="headband"></div>
<main class="main">
<div class="column">
<header class="header" itemscope="" itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
<div class="site-nav-toggle">
<div aria-label="切换导航栏" class="toggle" role="button">
<span class="toggle-line"></span>
<span class="toggle-line"></span>
<span class="toggle-line"></span>
</div>
</div>
<div class="site-meta">
<a class="brand" href="/blog/" rel="start">
<i class="logo-line"></i>
<p class="site-title">若凡的笔记</p>
<i class="logo-line"></i>
</a>
</div>
<div class="site-nav-right">
<div aria-label="搜索" class="toggle popup-trigger" role="button">
</div>
</div>
</div>
<nav class="site-nav">
<ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/blog/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/blog/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li>
</ul>
</nav>
</header>
<aside class="sidebar">
<div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
<ul class="sidebar-nav">
<li class="sidebar-nav-toc">
          文章目录
        </li>
<li class="sidebar-nav-overview">
          站点概览
        </li>
</ul>
<div class="sidebar-panel-container">
<!--noindex-->
<div class="post-toc-wrap sidebar-panel">
<div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AE%97%E6%B3%95%E5%AD%A6%E5%BE%97%E4%BC%9A%E7%9A%84%E5%8E%9F%E5%9B%A0"><span class="nav-number">1.</span> <span class="nav-text">算法学得会的原因</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%92%88%E5%AF%B9%E8%B4%AD%E7%89%A9%E7%AF%AE%E6%95%B0%E6%8D%AE%E9%9B%86%E7%9A%84%E5%85%B3%E8%81%94%E5%88%86%E6%9E%90"><span class="nav-number">2.</span> <span class="nav-text">针对购物篮数据集的关联分析</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="nav-number">2.1.</span> <span class="nav-text">基本概念</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#numpy-%E5%BA%93%E7%9A%84%E5%A4%9A%E7%BB%B4%E6%95%B0%E7%BB%84%E5%88%87%E7%89%87%E8%AF%AD%E6%B3%95"><span class="nav-number">2.2.</span> <span class="nav-text">numpy 库的多维数组切片语法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#apriori-%E7%AE%97%E6%B3%95"><span class="nav-number">2.3.</span> <span class="nav-text">Apriori 算法</span></a></li></ol></li></ol></div>
</div>
<!--/noindex-->
<div class="site-overview-wrap sidebar-panel">
<div class="site-author animated" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<p class="site-author-name" itemprop="name">Ruofan</p>
<div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
<nav class="site-state">
<div class="site-state-item site-state-posts">
<a href="/blog/">
<span class="site-state-item-count">32</span>
<span class="site-state-item-name">笔记</span>
</a>
</div>
<div class="site-state-item site-state-categories">
<a href="/blog/categories/">
<span class="site-state-item-count">3</span>
<span class="site-state-item-name">分类</span></a>
</div>
</nav>
</div>
</div>
</div>
</div>
</aside>
</div>
<div class="main-inner post posts-expand">
<div class="post-block">
<article class="post-content" itemscope="" itemtype="http://schema.org/Article" lang="zh-CN">
<link href="https://hrfis.me/blog/ds.html" itemprop="mainEntityOfPage"/>
<span hidden="" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<meta content="/blog/images/avatar.gif" itemprop="image"/>
<meta content="Ruofan" itemprop="name"/>
</span>
<span hidden="" itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
<meta content="若凡的笔记" itemprop="name"/>
<meta content="" itemprop="description"/>
</span>
<span hidden="" itemprop="post" itemscope="" itemtype="http://schema.org/CreativeWork">
<meta content="我就是学得会算法 | 若凡的笔记" itemprop="name"/>
<meta content="" itemprop="description"/>
</span>
<header class="post-header">
<h1 class="post-title" itemprop="name headline">
          我就是学得会算法
        </h1>
<div class="post-meta-container">
<div class="post-meta">
<span class="post-meta-item">
<span class="post-meta-item-icon">
<i class="far fa-calendar"></i>
</span>
<span class="post-meta-item-text">发表于</span>
<time datetime="2024-05-21T00:00:00+08:00" itemprop="dateCreated datePublished" title="创建时间：2024-05-21 00:00:00">2024-05-21</time>
</span>
<span class="post-meta-item">
<span class="post-meta-item-icon">
<i class="far fa-calendar-check"></i>
</span>
<span class="post-meta-item-text">更新于</span>
<time datetime="2024-06-03T20:41:19+08:00" itemprop="dateModified" title="修改时间：2024-06-03 20:41:19">2024-06-03</time>
</span>
<span class="post-meta-item">
<span class="post-meta-item-icon">
<i class="far fa-folder"></i>
</span>
<span class="post-meta-item-text">分类于</span>
<span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
<a href="/blog/p/" itemprop="url" rel="index"><span itemprop="name">实用系列</span></a>
</span>
</span>
</div>
</div>
</header>
<div class="post-body" itemprop="articleBody"><p>起因是两年前，《数据结构》及格了；《离散数学》及格了；《线性代数》在第四次及格了；《算法》也在第二次及格了。这四门课统称四小拦路蚂蚁。可以说是什么都及格了，太不拉胯了。</p>
<p>和写算法代码相比，写论文综述有意思、简单多了。因为你不只需要明白道理，还需要把它实现出来。当然这同时指的是前两件事。</p>
<span id="more"></span>
<h2 id="算法学得会的原因">算法学得会的原因</h2>
<p>不仅仅是算法，把这个套到其他事情上面也是一样：因为<strong>你明白基础概念</strong>。比如写二分查找，<strong>你知道二分查找用几个指针</strong>，人家是摸着石头过河，你也是。你的大部分时间都节省在：我<strong>不从头开始想</strong>，我应该怎么实现它，而是先<strong>看</strong>一遍别人的代码，看明白之后再<strong>背</strong>一遍。或者当你看别人的代码的时候，你会发现你还是看得懂：为什么看得懂？因为<strong>你知道这个算法到底是用来干什么的</strong>。当你自己想得出来，看别人代码也看得懂，又愿意看基础概念的时候，你就不会怀疑自已的能力，然后<strong><em>打破一个循环</em></strong>：为什么我写不出来？</p>
<p>二分查找是什么意思？查找，是根据一个<strong>输入值</strong>，查找数组里面与<strong>该输入值相等的数的索引</strong>。二分，是<strong>缩小查找的范围</strong>，怎么二分？前提数组是<strong>有序</strong>的，把你要查找的值<strong>和正中间的值做比较</strong>，分成左半部分和右边部分，如果你要查找的值比中间值小，就在左半部分查找。怎么在左半部分查找？<strong>变换查找的边界，同时和新的中间的值做比较</strong>。<strong>构成查找边界</strong>的有两个指针，<strong>指向中间值</strong>的又是一个指针，<strong>所以</strong>才需要三个指针。</p>
<h2 id="针对购物篮数据集的关联分析">针对购物篮数据集的关联分析</h2>
<h3 id="基本概念">基本概念</h3>
<p>关联分析到底是<strong>什么意思</strong>？是发现隐藏在大型<strong>数据集</strong>中的有意义的<strong>联系</strong>。</p>
<p>购物篮数据集<strong>怎么表示</strong>？是一张<strong>表</strong>，表里有一系列<strong>行</strong>，每一个行是一个<strong>事务</strong>，每一个事务表现为一个<strong>集合</strong>，这个集合里有一系列商品的<strong>名字</strong>，比如{"面包","牛奶","尿布"}</p>
<p>联系<strong>怎么表示</strong>？有两种形式：<strong>关联规则</strong>、和<strong>频繁项集</strong></p>
<p>关联规则是<strong>什么意思</strong>？是<strong>两个不相交集合的蕴含表达式</strong>，如{尿布}-&gt;{啤酒}这个表达式的意思是：购买尿布，<strong>引起了</strong>购买啤酒，前面是<strong>因</strong>、后面是<strong>果</strong>。</p>
<p>项集是<strong>什么意思</strong>？是一些<strong>项</strong>的<strong>集合</strong>。是
<code>list[str]</code></p>
<p>什么叫<strong>频繁项集</strong>？是<strong>支持度</strong>或者<strong>支持度计数大于等于最小阈值</strong>的项集。</p>
<p>什么叫<strong>支持度计数</strong>？是该项集在事务列表里的<strong>超集数量</strong>，是事务列表里的所有<strong>包含该项集</strong>的<strong>事务数量</strong>。</p>
<p>什么叫<strong>支持度</strong>？是事务列表里，<strong>包含该项集的事务的数量</strong>占<strong>所有事务数量</strong>里的比值。</p>
<p>{面包，牛奶}支持度 0.3
是<strong>什么意思</strong>？是在所有的购物记录里，同时包含购买了面包、牛奶的购物记录的比值。是<strong>在每
10 次购物里，就有三次同时购买了面包和啤酒</strong>。</p>
<p><strong>怎么挖掘关联规则</strong>？分两步：</p>
<ol type="1">
<li><strong>产生频繁项集</strong>:发现满足最小支持度阈值的所有项集
<ul>
<li>什么意思？项集里有几个元素？<strong>最少</strong>有一个，<strong>最多</strong>有
<code>len(unique(flatten(basket)))</code>
个，是所有独立的商品组成的集合。</li>
</ul></li>
<li><strong>产生规则</strong>
<ul>
<li>提取所有高置信度的规则。</li>
</ul></li>
</ol>
<p>格结构是什么意思？格结构里的所有节点构成一个集合的幂集。格结构的第一层是
null，第二层是所有 1-项集，第三层是所有 2-项集……最底层是
<code>len(unique(flatten(basket)))</code>项集</p>
<p><strong>先验原理</strong>是什么意思？如果一个<strong>项集</strong>是<strong>频繁</strong>的，它的<strong>所有子集</strong>都一定是<strong>频繁的</strong>。</p>
<p>什么叫一个项集是频繁的？它的支持度计数大于等于最小阈值</p>
<p>什么叫一个项集的子集是频繁的？它的子集的支持度计数大于等于最小阈值</p>
<p>为什么项集支持度计数大于等于最小阈值后，它的所有子集的支持度计数都会大于等于最小阈值？</p>
<p>因为：就是这样，我明白，但是就是<strong>说得出来</strong>。那说明还是<strong>明白</strong>。</p>
<p><strong>支持度计数 +1
的操作是在什么时候</strong>？把这个项集和事务列表里的所有项集做比较，如果该项集是事务列表里项集的子集，把该项集的支持度计数
+1。所以：支持度计数，就是<strong>找超集数量</strong></p>
<p><strong>一个集合的子集的超集数量</strong>，必定<strong>大于等于该集合的超集数量</strong>，为什么？<strong>因为这个集合本身就是它子集的超集</strong>。</p>
<p>好了，现在明白了。</p>
<p>什么叫<strong>基于支持度的剪枝</strong>？把先验原理<strong>反过来说</strong>：如果一个项集是非频繁的，它的所有超集都是非频繁的。</p>
<p>非频繁是什么意思？支持度计数小于最小阈值，超集数量小于最小阈值，<strong>包含它的事务数量</strong>小于最小阈值</p>
<p>如果一个集合的超集数量小于最小阈值，它的（所有超集）的超集数量都会小于最小阈值。为什么？<strong>你确定这句话对吗</strong>？</p>
<p>正确的描述方法是：如果<strong>包含 A 的事务数</strong>小于最小阈值，
那么<strong>包含（A
的超集）的事务数</strong>会小于最小阈值。为什么？</p>
<p>因为在一个购物篮里，事务数量是有限的。</p>
<p>只会说这一句话吗？如果不只会说这一句，说明你<strong>还是明白</strong>。为什么？</p>
<p><strong>支持度计数 +1
的操作是在什么时候</strong>？是针对一个项集，<strong>判断各个事务</strong>是不是它的超集的时候。还是明白。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/></pre></td><td class="code"><pre><span class="line">basket = [</span><br/><span class="line">    [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],</span><br/><span class="line">    [<span class="number">1</span>,<span class="number">3</span>,<span class="number">4</span>],</span><br/><span class="line">    [<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>],</span><br/><span class="line">    [<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>]</span><br/><span class="line">]</span><br/></pre></td></tr></table></figure>
<p>问：[2,3] 的支持度计数是几？是 2，是第一行和第四行</p>
<p>现在规定：最小支持度计数是
3。问，[2,3]超集的支持度计数？既然是超集，考虑它自己是它自己的超集这种情况，它的支持度计数还是小于
3。现在再往里加一个，能达到要求吗？加一个之后，<strong>超集的判定变严了</strong>。不只能说出这一句感性的话，说明你还是明白。因为
<strong><em>算法不只讲感性</em></strong>。</p>
<p>理性的说法是：原来是 A 超集的集合 B，在 A 加一个元素之后变成 C 后，B
不一定还是 C 的超集，因为新加的那个元素可能不在 B
里。如果新加的那个元素在 B 里，C
超集的数量（相对于购物篮）至少减零。如果不在 B 里，C
超集的数量（相对于购物篮）至少减一。</p>
<p>好了，现在明白了。</p>
<p><strong>基于支持度的剪枝</strong>什么意思？如果<strong>一个项集是非频繁的</strong>，把它格结构里<strong>所有的超集剪了</strong>。</p>
<p><strong>反单调性</strong>什么意思？一个项集的支持度小于等于它的自己的支持度。</p>
<h3 id="numpy-库的多维数组切片语法">numpy 库的多维数组切片语法</h3>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/><span class="line">10</span><br/><span class="line">11</span><br/><span class="line">12</span><br/><span class="line">13</span><br/><span class="line">14</span><br/><span class="line">15</span><br/><span class="line">16</span><br/><span class="line">17</span><br/><span class="line">18</span><br/><span class="line">19</span><br/><span class="line">20</span><br/><span class="line">21</span><br/><span class="line">22</span><br/><span class="line">23</span><br/><span class="line">24</span><br/><span class="line">25</span><br/><span class="line">26</span><br/></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br/><span class="line"><span class="comment"># 假装这是事务列表</span></span><br/><span class="line">X = np.array(</span><br/><span class="line">    [</span><br/><span class="line">        [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>],</span><br/><span class="line">        [<span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>],</span><br/><span class="line">        [<span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">21</span>],</span><br/><span class="line">        [<span class="number">22</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>],</span><br/><span class="line">    ]</span><br/><span class="line">)</span><br/><span class="line"><span class="comment"># 假装这是一系列3-项集</span></span><br/><span class="line">combin = np.array([[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>], [<span class="number">1</span>, <span class="number">4</span>, <span class="number">6</span>]])</span><br/><span class="line"><span class="built_in">print</span>(X[:, combin])</span><br/><span class="line"></span><br/><span class="line"><span class="string">"""</span></span><br/><span class="line"><span class="string">这是什么玩意？？？</span></span><br/><span class="line"><span class="string">[[[ 1  2  3]</span></span><br/><span class="line"><span class="string">  [ 2  5  7]] 把第一个事务的对应的各个3-项集摘出来（可能有True有False），便于后续判断它是不是某个3-项集的子集</span></span><br/><span class="line"><span class="string">              如果第二行全True，说明该事务是[1,4,6]的超集</span></span><br/><span class="line"><span class="string"></span></span><br/><span class="line"><span class="string"> [[ 8  9 10]</span></span><br/><span class="line"><span class="string">  [ 9 12 14]]</span></span><br/><span class="line"><span class="string"></span></span><br/><span class="line"><span class="string"> [[15 16 17]</span></span><br/><span class="line"><span class="string">  [16 19 21]]]</span></span><br/><span class="line"><span class="string">"""</span></span><br/></pre></td></tr></table></figure>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/><span class="line">10</span><br/><span class="line">11</span><br/><span class="line">12</span><br/><span class="line">13</span><br/><span class="line">14</span><br/><span class="line">15</span><br/><span class="line">16</span><br/><span class="line">17</span><br/><span class="line">18</span><br/><span class="line">19</span><br/><span class="line">20</span><br/><span class="line">21</span><br/><span class="line">22</span><br/><span class="line">23</span><br/><span class="line">24</span><br/><span class="line">25</span><br/><span class="line">26</span><br/><span class="line">27</span><br/><span class="line">28</span><br/><span class="line">29</span><br/><span class="line">30</span><br/><span class="line">31</span><br/><span class="line">32</span><br/><span class="line">33</span><br/><span class="line">34</span><br/><span class="line">35</span><br/><span class="line">36</span><br/></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br/><span class="line"></span><br/><span class="line">X = np.array(</span><br/><span class="line">    [</span><br/><span class="line">        [<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br/><span class="line">        [<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br/><span class="line">        [<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br/><span class="line">        [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br/><span class="line">    ]</span><br/><span class="line">)</span><br/><span class="line">combin = np.array([[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>], [<span class="number">1</span>, <span class="number">4</span>, <span class="number">6</span>]])</span><br/><span class="line"><span class="built_in">print</span>(X[:, combin])</span><br/><span class="line"></span><br/><span class="line"><span class="string">"""</span></span><br/><span class="line"><span class="string">[[[1 0 0]</span></span><br/><span class="line"><span class="string">  [0 0 0]] 把对应的3-项集摘出来</span></span><br/><span class="line"><span class="string"></span></span><br/><span class="line"><span class="string"> [[1 1 1]</span></span><br/><span class="line"><span class="string">  [1 0 0]] 全1为True，说明第二行事务它是对应[0,1,2]的超集</span></span><br/><span class="line"><span class="string"></span></span><br/><span class="line"><span class="string"> [[1 0 1]</span></span><br/><span class="line"><span class="string">  [0 0 0]]</span></span><br/><span class="line"><span class="string"></span></span><br/><span class="line"><span class="string"> [[0 0 0]</span></span><br/><span class="line"><span class="string">  [0 1 0]]]</span></span><br/><span class="line"><span class="string">"""</span></span><br/><span class="line"></span><br/><span class="line">_bools = np.<span class="built_in">all</span>(X[:, combin], axis=<span class="number">2</span>)</span><br/><span class="line"><span class="built_in">print</span>(_bools)</span><br/><span class="line"></span><br/><span class="line"><span class="string">"""</span></span><br/><span class="line"><span class="string">[[False False]</span></span><br/><span class="line"><span class="string"> [ True False] 四个事务里，只有这一个事务是[0,1,2]的超集</span></span><br/><span class="line"><span class="string"> [False False]</span></span><br/><span class="line"><span class="string"> [False False]]</span></span><br/><span class="line"><span class="string">"""</span></span><br/></pre></td></tr></table></figure>
<h3 id="apriori-算法">Apriori 算法</h3>
<pre class="mermaid">%%{
    init: {
        "theme": "neutral",
        "fontFamily": "Times New Roman"
    }
}%%
flowchart TD
    A[产生频繁1-项集] --&gt; B[k=1] --&gt; C[k+=1] --&gt; G[由频繁k-1-项集生成候选k-项集,并剪枝] --&gt; D{候选k-项集为空?}
    D -- 是 --&gt; E[返回频繁项集]
    D -- 否 --&gt; F[对候选k-项集支持度计数,产生频繁k-项集] --&gt; GG{频繁k-项集为空?} -- 是 --&gt; E
    GG -- 否 --&gt; C</pre>
<p>直接看 mlxtend
库的源码（删除了一些相对于算法本身无关紧要的，比如低内存下的算法和
pandas 兼容性的问题）：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/><span class="line">10</span><br/><span class="line">11</span><br/><span class="line">12</span><br/><span class="line">13</span><br/><span class="line">14</span><br/><span class="line">15</span><br/><span class="line">16</span><br/><span class="line">17</span><br/><span class="line">18</span><br/><span class="line">19</span><br/><span class="line">20</span><br/><span class="line">21</span><br/><span class="line">22</span><br/><span class="line">23</span><br/><span class="line">24</span><br/><span class="line">25</span><br/><span class="line">26</span><br/><span class="line">27</span><br/><span class="line">28</span><br/><span class="line">29</span><br/><span class="line">30</span><br/><span class="line">31</span><br/><span class="line">32</span><br/><span class="line">33</span><br/><span class="line">34</span><br/><span class="line">35</span><br/><span class="line">36</span><br/><span class="line">37</span><br/><span class="line">38</span><br/><span class="line">39</span><br/><span class="line">40</span><br/><span class="line">41</span><br/><span class="line">42</span><br/><span class="line">43</span><br/><span class="line">44</span><br/><span class="line">45</span><br/><span class="line">46</span><br/><span class="line">47</span><br/><span class="line">48</span><br/><span class="line">49</span><br/><span class="line">50</span><br/><span class="line">51</span><br/><span class="line">52</span><br/><span class="line">53</span><br/><span class="line">54</span><br/><span class="line">55</span><br/><span class="line">56</span><br/><span class="line">57</span><br/><span class="line">58</span><br/><span class="line">59</span><br/><span class="line">60</span><br/><span class="line">61</span><br/><span class="line">62</span><br/><span class="line">63</span><br/><span class="line">64</span><br/><span class="line">65</span><br/><span class="line">66</span><br/><span class="line">67</span><br/><span class="line">68</span><br/><span class="line">69</span><br/><span class="line">70</span><br/><span class="line">71</span><br/><span class="line">72</span><br/><span class="line">73</span><br/><span class="line">74</span><br/><span class="line">75</span><br/><span class="line">76</span><br/><span class="line">77</span><br/><span class="line">78</span><br/><span class="line">79</span><br/><span class="line">80</span><br/><span class="line">81</span><br/><span class="line">82</span><br/><span class="line">83</span><br/><span class="line">84</span><br/><span class="line">85</span><br/><span class="line">86</span><br/><span class="line">87</span><br/><span class="line">88</span><br/><span class="line">89</span><br/><span class="line">90</span><br/><span class="line">91</span><br/><span class="line">92</span><br/><span class="line">93</span><br/><span class="line">94</span><br/><span class="line">95</span><br/><span class="line">96</span><br/><span class="line">97</span><br/><span class="line">98</span><br/><span class="line">99</span><br/><span class="line">100</span><br/><span class="line">101</span><br/><span class="line">102</span><br/><span class="line">103</span><br/><span class="line">104</span><br/><span class="line">105</span><br/><span class="line">106</span><br/><span class="line">107</span><br/><span class="line">108</span><br/><span class="line">109</span><br/><span class="line">110</span><br/><span class="line">111</span><br/><span class="line">112</span><br/><span class="line">113</span><br/><span class="line">114</span><br/><span class="line">115</span><br/><span class="line">116</span><br/><span class="line">117</span><br/><span class="line">118</span><br/><span class="line">119</span><br/><span class="line">120</span><br/><span class="line">121</span><br/><span class="line">122</span><br/><span class="line">123</span><br/><span class="line">124</span><br/><span class="line">125</span><br/><span class="line">126</span><br/><span class="line">127</span><br/><span class="line">128</span><br/><span class="line">129</span><br/><span class="line">130</span><br/><span class="line">131</span><br/><span class="line">132</span><br/><span class="line">133</span><br/><span class="line">134</span><br/><span class="line">135</span><br/><span class="line">136</span><br/><span class="line">137</span><br/><span class="line">138</span><br/><span class="line">139</span><br/><span class="line">140</span><br/><span class="line">141</span><br/><span class="line">142</span><br/><span class="line">143</span><br/><span class="line">144</span><br/><span class="line">145</span><br/><span class="line">146</span><br/><span class="line">147</span><br/><span class="line">148</span><br/><span class="line">149</span><br/><span class="line">150</span><br/><span class="line">151</span><br/><span class="line">152</span><br/><span class="line">153</span><br/><span class="line">154</span><br/><span class="line">155</span><br/><span class="line">156</span><br/><span class="line">157</span><br/><span class="line">158</span><br/><span class="line">159</span><br/><span class="line">160</span><br/><span class="line">161</span><br/><span class="line">162</span><br/><span class="line">163</span><br/><span class="line">164</span><br/><span class="line">165</span><br/><span class="line">166</span><br/><span class="line">167</span><br/><span class="line">168</span><br/><span class="line">169</span><br/><span class="line">170</span><br/><span class="line">171</span><br/><span class="line">172</span><br/><span class="line">173</span><br/><span class="line">174</span><br/><span class="line">175</span><br/><span class="line">176</span><br/><span class="line">177</span><br/><span class="line">178</span><br/><span class="line">179</span><br/><span class="line">180</span><br/><span class="line">181</span><br/><span class="line">182</span><br/><span class="line">183</span><br/><span class="line">184</span><br/><span class="line">185</span><br/><span class="line">186</span><br/><span class="line">187</span><br/><span class="line">188</span><br/><span class="line">189</span><br/><span class="line">190</span><br/><span class="line">191</span><br/><span class="line">192</span><br/><span class="line">193</span><br/><span class="line">194</span><br/><span class="line">195</span><br/><span class="line">196</span><br/><span class="line">197</span><br/><span class="line">198</span><br/><span class="line">199</span><br/><span class="line">200</span><br/><span class="line">201</span><br/><span class="line">202</span><br/><span class="line">203</span><br/><span class="line">204</span><br/><span class="line">205</span><br/><span class="line">206</span><br/><span class="line">207</span><br/><span class="line">208</span><br/><span class="line">209</span><br/><span class="line">210</span><br/><span class="line">211</span><br/><span class="line">212</span><br/><span class="line">213</span><br/><span class="line">214</span><br/><span class="line">215</span><br/><span class="line">216</span><br/><span class="line">217</span><br/><span class="line">218</span><br/><span class="line">219</span><br/><span class="line">220</span><br/><span class="line">221</span><br/><span class="line">222</span><br/><span class="line">223</span><br/><span class="line">224</span><br/><span class="line">225</span><br/><span class="line">226</span><br/><span class="line">227</span><br/><span class="line">228</span><br/><span class="line">229</span><br/><span class="line">230</span><br/><span class="line">231</span><br/><span class="line">232</span><br/><span class="line">233</span><br/><span class="line">234</span><br/><span class="line">235</span><br/><span class="line">236</span><br/><span class="line">237</span><br/><span class="line">238</span><br/><span class="line">239</span><br/><span class="line">240</span><br/><span class="line">241</span><br/><span class="line">242</span><br/><span class="line">243</span><br/><span class="line">244</span><br/><span class="line">245</span><br/><span class="line">246</span><br/><span class="line">247</span><br/><span class="line">248</span><br/></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> mlxtend.preprocessing <span class="keyword">import</span> TransactionEncoder</span><br/><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br/><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br/><span class="line"></span><br/><span class="line"></span><br/><span class="line"><span class="keyword">def</span> <span class="title function_">generate_new_combinations</span>(<span class="params">old_combinations</span>):</span><br/><span class="line">    <span class="string">"""</span></span><br/><span class="line"><span class="string">    由上一步的频繁k-1项集生成候选项k集，并剪枝</span></span><br/><span class="line"><span class="string">    """</span></span><br/><span class="line">    items_types_in_previous_step = np.unique(old_combinations.flatten())</span><br/><span class="line">    <span class="built_in">print</span>(items_types_in_previous_step)</span><br/><span class="line">    <span class="string">"""</span></span><br/><span class="line"><span class="string">    [0 1 2 3 4]</span></span><br/><span class="line"><span class="string">    """</span></span><br/><span class="line">    <span class="keyword">for</span> old_combination <span class="keyword">in</span> old_combinations:</span><br/><span class="line">        <span class="string">"""上一步的频繁2-项集</span></span><br/><span class="line"><span class="string">        [[0 1] 第一次循环</span></span><br/><span class="line"><span class="string">         [0 3] 第二次循环</span></span><br/><span class="line"><span class="string">         [0 4] 第三次循环</span></span><br/><span class="line"><span class="string">         [1 2]</span></span><br/><span class="line"><span class="string">         [1 3]</span></span><br/><span class="line"><span class="string">         [1 4]</span></span><br/><span class="line"><span class="string">         [2 3]</span></span><br/><span class="line"><span class="string">         [3 4]]</span></span><br/><span class="line"><span class="string">        """</span></span><br/><span class="line">        max_combination = old_combination[-<span class="number">1</span>]</span><br/><span class="line">        mask = items_types_in_previous_step &gt; max_combination</span><br/><span class="line">        valid_items = items_types_in_previous_step[mask]</span><br/><span class="line">        <span class="string">"""</span></span><br/><span class="line"><span class="string">        [2 3 4] 第一次循环，取了[0 1 2 3 4]里比old_combination[0][-1]大的部分</span></span><br/><span class="line"><span class="string">        [4] 第二次循环，取了[0 1 2 3 4]里比old_combination[1][-1]大的部分</span></span><br/><span class="line"><span class="string">        []  第三次循环，取了[0 1 2 3 4]里比old_combination[2][-1]大的部分</span></span><br/><span class="line"><span class="string">        [3 4]</span></span><br/><span class="line"><span class="string">        [4]</span></span><br/><span class="line"><span class="string">        []</span></span><br/><span class="line"><span class="string">        [4]</span></span><br/><span class="line"><span class="string">        []</span></span><br/><span class="line"><span class="string">        """</span></span><br/><span class="line">        old_tuple = <span class="built_in">tuple</span>(old_combination)</span><br/><span class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> valid_items:</span><br/><span class="line">            <span class="keyword">yield</span> <span class="keyword">from</span> old_tuple</span><br/><span class="line">            <span class="keyword">yield</span> item</span><br/><span class="line">        <span class="string">"""</span></span><br/><span class="line"><span class="string">       [[0 1 2] 第一次循环，由[0 1]再生成[0,1,2]</span></span><br/><span class="line"><span class="string">        [0 1 3] 第一次循环</span></span><br/><span class="line"><span class="string">        [0 1 4] 第一次循环</span></span><br/><span class="line"><span class="string">        [0 3 4] 第二次循环</span></span><br/><span class="line"><span class="string">        [1 2 3] 第四次循环（第三次valid_items为空）</span></span><br/><span class="line"><span class="string">        [1 2 4] 第四次循环</span></span><br/><span class="line"><span class="string">        [1 3 4] 第五次循环</span></span><br/><span class="line"><span class="string">        [2 3 4]] 第七次循环</span></span><br/><span class="line"><span class="string">       """</span></span><br/><span class="line"></span><br/><span class="line"></span><br/><span class="line"><span class="keyword">def</span> <span class="title function_">apriori</span>(<span class="params">df, min_support=<span class="number">0.3</span></span>):</span><br/><span class="line">    <span class="string">"""</span></span><br/><span class="line"><span class="string">    它传进去一个df，每一行是一个事务记录，纯bool类型，True就是包含列名（商品），False就是不包含</span></span><br/><span class="line"><span class="string">    """</span></span><br/><span class="line"></span><br/><span class="line">    <span class="comment"># print(df)</span></span><br/><span class="line">    <span class="keyword">def</span> <span class="title function_">_support</span>(<span class="params">_x, _n_rows</span>):</span><br/><span class="line">        <span class="string">"""</span></span><br/><span class="line"><span class="string">        计算支持度。它按每一列求和，输出一个一维数组，是每一列里True的数量占总行数的比值</span></span><br/><span class="line"><span class="string">        """</span></span><br/><span class="line">        <span class="comment"># print(_x)</span></span><br/><span class="line">        out = np.<span class="built_in">sum</span>(_x, axis=<span class="number">0</span>) / _n_rows</span><br/><span class="line">        <span class="comment"># print(out)</span></span><br/><span class="line">        <span class="keyword">return</span> np.array(out).reshape(-<span class="number">1</span>)</span><br/><span class="line"></span><br/><span class="line">    X = df.values  <span class="comment"># 二维数组</span></span><br/><span class="line">    support = _support(X, X.shape[<span class="number">0</span>])  <span class="comment"># 所有1-项集的支持度</span></span><br/><span class="line">    ary_col_idx = np.arange(X.shape[<span class="number">1</span>])  <span class="comment"># 列索引，即不同商品的编号</span></span><br/><span class="line"></span><br/><span class="line">    support_dict = {<span class="number">1</span>: support[support &gt;= min_support]}</span><br/><span class="line">    <span class="comment"># print(f"频繁1-项集的支持度\n{support_dict}")</span></span><br/><span class="line">    itemset_dict = {<span class="number">1</span>: ary_col_idx[support &gt;= min_support].reshape(-<span class="number">1</span>, <span class="number">1</span>)}</span><br/><span class="line">    <span class="comment"># print(f"频繁1-项集\n{itemset_dict}")</span></span><br/><span class="line"></span><br/><span class="line">    max_itemset = <span class="number">1</span>  <span class="comment"># 最大k项集里的k</span></span><br/><span class="line">    rows_count = <span class="built_in">float</span>(X.shape[<span class="number">0</span>])  <span class="comment"># 行数，即事务数</span></span><br/><span class="line"></span><br/><span class="line">    <span class="keyword">while</span> max_itemset:</span><br/><span class="line">        next_max_itemset = max_itemset + <span class="number">1</span>  <span class="comment"># 开始计算2-项集</span></span><br/><span class="line">        combin = generate_new_combinations(</span><br/><span class="line">            itemset_dict[max_itemset]</span><br/><span class="line">        )  <span class="comment"># 把频繁1-项集传进去，返回一个包含所有候选2-项集的生成器</span></span><br/><span class="line"></span><br/><span class="line">        <span class="comment"># 把生成器转成正经的数组</span></span><br/><span class="line">        combin = np.fromiter(combin, dtype=<span class="built_in">int</span>)</span><br/><span class="line">        combin = combin.reshape(-<span class="number">1</span>, next_max_itemset)</span><br/><span class="line">        <span class="comment"># 结束条件：候选k-项集为空</span></span><br/><span class="line">        <span class="keyword">if</span> combin.size == <span class="number">0</span>:</span><br/><span class="line">            <span class="keyword">break</span></span><br/><span class="line">        <span class="built_in">print</span>(</span><br/><span class="line">            <span class="string">f"Processing <span class="subst">{combin.size}</span> combinations | Sampling itemset size <span class="subst">{next_max_itemset}</span>\n"</span></span><br/><span class="line">        )</span><br/><span class="line"></span><br/><span class="line">        <span class="comment"># print(combin)</span></span><br/><span class="line">        <span class="string">"""第一次循环，候选2-项集</span></span><br/><span class="line"><span class="string">        [[0 1]</span></span><br/><span class="line"><span class="string">         [0 2]</span></span><br/><span class="line"><span class="string">         [0 3]</span></span><br/><span class="line"><span class="string">         [0 4]</span></span><br/><span class="line"><span class="string">         [1 2]</span></span><br/><span class="line"><span class="string">         [1 3]</span></span><br/><span class="line"><span class="string">         [1 4]</span></span><br/><span class="line"><span class="string">         [2 3]</span></span><br/><span class="line"><span class="string">         [2 4]</span></span><br/><span class="line"><span class="string">         [3 4]]</span></span><br/><span class="line"><span class="string">        """</span></span><br/><span class="line">        <span class="string">"""第二次循环，候选3-项集</span></span><br/><span class="line"><span class="string">        [[0 1 2]</span></span><br/><span class="line"><span class="string">         [0 1 3]</span></span><br/><span class="line"><span class="string">         [0 1 4]</span></span><br/><span class="line"><span class="string">         [0 3 4]</span></span><br/><span class="line"><span class="string">         [1 2 3]</span></span><br/><span class="line"><span class="string">         [1 2 4]</span></span><br/><span class="line"><span class="string">         [1 3 4]</span></span><br/><span class="line"><span class="string">         [2 3 4]]</span></span><br/><span class="line"><span class="string">        """</span></span><br/><span class="line">        <span class="comment"># print(X)</span></span><br/><span class="line">        <span class="string">"""事务列表</span></span><br/><span class="line"><span class="string">        [[ True  True False  True  True]</span></span><br/><span class="line"><span class="string">         [False  True  True  True False]</span></span><br/><span class="line"><span class="string">         [ True  True False  True  True]</span></span><br/><span class="line"><span class="string">         [ True False  True  True  True]</span></span><br/><span class="line"><span class="string">         [False  True  True  True  True]</span></span><br/><span class="line"><span class="string">         [False  True False  True  True]</span></span><br/><span class="line"><span class="string">         [False False  True  True False]</span></span><br/><span class="line"><span class="string">         [ True  True  True False False]</span></span><br/><span class="line"><span class="string">         [ True False False  True  True]</span></span><br/><span class="line"><span class="string">         [False  True False  True False]]</span></span><br/><span class="line"><span class="string">        """</span></span><br/><span class="line">        <span class="comment"># print(</span></span><br/><span class="line">        <span class="comment">#    X[:, combin]</span></span><br/><span class="line">        <span class="comment"># )  # 对事务列表里的每行（事务）切片，选出，作为三维数组的第二维，便于后续判断超集关系</span></span><br/><span class="line">        _bools = np.<span class="built_in">all</span>(X[:, combin], axis=<span class="number">2</span>)</span><br/><span class="line">        <span class="comment"># print(_bools)</span></span><br/><span class="line">        <span class="string">"""第一次循环</span></span><br/><span class="line"><span class="string">        [[ True False  True  True False  True  True False False  True] 这个事务是6个候选2-项集的超集</span></span><br/><span class="line"><span class="string">         [False False False False  True  True False  True False False] 这个事务是3个候选2-项集的超集</span></span><br/><span class="line"><span class="string">         [ True False  True  True False  True  True False False  True]</span></span><br/><span class="line"><span class="string">         [False  True  True  True False False False  True  True  True]</span></span><br/><span class="line"><span class="string">         [False False False False  True  True  True  True  True  True]</span></span><br/><span class="line"><span class="string">         [False False False False False  True  True False False  True]</span></span><br/><span class="line"><span class="string">         [False False False False False False False  True False False]</span></span><br/><span class="line"><span class="string">         [ True  True False False  True False False False False False]</span></span><br/><span class="line"><span class="string">         [False False  True  True False False False False False  True]</span></span><br/><span class="line"><span class="string">         [False False False False False  True False False False False]]</span></span><br/><span class="line"><span class="string">        """</span></span><br/><span class="line">        <span class="string">"""第二次循环</span></span><br/><span class="line"><span class="string">        [[False  True  True  True False False  True False] 这个事务是4个候选3-项集的超集</span></span><br/><span class="line"><span class="string">         [False False False False  True False False False] 这个事务是1个候选3-项集的超集</span></span><br/><span class="line"><span class="string">         [False  True  True  True False False  True False]</span></span><br/><span class="line"><span class="string">         [False False False  True False False False  True]</span></span><br/><span class="line"><span class="string">         [False False False False  True  True  True  True]</span></span><br/><span class="line"><span class="string">         [False False False False False False  True False]</span></span><br/><span class="line"><span class="string">         [False False False False False False False False]</span></span><br/><span class="line"><span class="string">         [ True False False False False False False False]</span></span><br/><span class="line"><span class="string">         [False False False  True False False False False]</span></span><br/><span class="line"><span class="string">         [False False False False False False False False]]</span></span><br/><span class="line"><span class="string">        """</span></span><br/><span class="line">        support = _support(np.array(_bools), rows_count)</span><br/><span class="line">        <span class="comment"># print(support)</span></span><br/><span class="line">        <span class="string">"""第一次循环，对每一列求和，对应每一个候选2-项集的支持度</span></span><br/><span class="line"><span class="string">        [0.3 0.2 0.4 0.4 0.3 0.6 0.4 0.4 0.2 0.6]</span></span><br/><span class="line"><span class="string">        """</span></span><br/><span class="line">        <span class="string">"""第二次循环，对每一列求和，对应每一个候选3-项集的支持度</span></span><br/><span class="line"><span class="string">        [0.1 0.2 0.2 0.4 0.2 0.1 0.4 0.2]</span></span><br/><span class="line"><span class="string">        """</span></span><br/><span class="line">        _mask = (support &gt;= min_support).reshape(</span><br/><span class="line">            -<span class="number">1</span></span><br/><span class="line">        )  <span class="comment"># 遮罩，后续对候选项集combin作用，过滤出频繁项集</span></span><br/><span class="line">        <span class="comment"># print(_mask)</span></span><br/><span class="line">        <span class="string">"""第一次循环，每个候选2-项集的支持度是否大于最小支持度</span></span><br/><span class="line"><span class="string">        [ True False  True  True  True  True  True  True False  True]</span></span><br/><span class="line"><span class="string">        """</span></span><br/><span class="line">        <span class="string">"""第二次循环，每个候选3-项集的支持度是否大于最小支持度</span></span><br/><span class="line"><span class="string">        [False False False  True False False  True False]</span></span><br/><span class="line"><span class="string">        """</span></span><br/><span class="line"></span><br/><span class="line">        <span class="keyword">if</span> <span class="built_in">any</span>(_mask):</span><br/><span class="line">            itemset_dict[next_max_itemset] = np.array(combin[_mask])</span><br/><span class="line">            <span class="comment"># print(combin[_mask])</span></span><br/><span class="line">            <span class="string">"""第一次循环，频繁2-项集</span></span><br/><span class="line"><span class="string">            [[0 1]</span></span><br/><span class="line"><span class="string">             [0 3]</span></span><br/><span class="line"><span class="string">             [0 4]</span></span><br/><span class="line"><span class="string">             [1 2]</span></span><br/><span class="line"><span class="string">             [1 3]</span></span><br/><span class="line"><span class="string">             [1 4]</span></span><br/><span class="line"><span class="string">             [2 3]</span></span><br/><span class="line"><span class="string">             [3 4]]</span></span><br/><span class="line"><span class="string">            """</span></span><br/><span class="line">            <span class="string">"""第二次循环，频繁3-项集</span></span><br/><span class="line"><span class="string">            [[0 3 4]</span></span><br/><span class="line"><span class="string">             [1 3 4]]</span></span><br/><span class="line"><span class="string">            """</span></span><br/><span class="line">            support_dict[next_max_itemset] = np.array(support[_mask])</span><br/><span class="line">            <span class="comment"># print(support[_mask])</span></span><br/><span class="line">            <span class="string">"""第一次循环，频繁2-项集的支持度</span></span><br/><span class="line"><span class="string">            [0.3 0.4 0.4 0.3 0.6 0.4 0.4 0.6]</span></span><br/><span class="line"><span class="string">            """</span></span><br/><span class="line">            <span class="string">"""第二次循环，频繁3-项集的支持度</span></span><br/><span class="line"><span class="string">            [0.4 0.4]</span></span><br/><span class="line"><span class="string">            """</span></span><br/><span class="line">            max_itemset = next_max_itemset</span><br/><span class="line">        <span class="keyword">else</span>:</span><br/><span class="line">            <span class="comment"># Exit condition</span></span><br/><span class="line">            <span class="keyword">break</span></span><br/><span class="line"></span><br/><span class="line">    <span class="comment"># 返回结果的操作</span></span><br/><span class="line">    all_res = []</span><br/><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">sorted</span>(itemset_dict):</span><br/><span class="line">        support = pd.Series(support_dict[k])</span><br/><span class="line">        itemsets = pd.Series([<span class="built_in">frozenset</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> itemset_dict[k]], dtype=<span class="string">"object"</span>)</span><br/><span class="line">        res = pd.concat((support, itemsets), axis=<span class="number">1</span>)</span><br/><span class="line">        all_res.append(res)</span><br/><span class="line"></span><br/><span class="line">    res_df = pd.concat(all_res)</span><br/><span class="line">    res_df.columns = [<span class="string">"support"</span>, <span class="string">"itemsets"</span>]</span><br/><span class="line">    res_df = res_df.reset_index(drop=<span class="literal">True</span>)</span><br/><span class="line"></span><br/><span class="line">    <span class="built_in">print</span>()</span><br/><span class="line"></span><br/><span class="line">    <span class="keyword">return</span> res_df</span><br/><span class="line"></span><br/><span class="line"></span><br/><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br/><span class="line">    itemSetList = [</span><br/><span class="line">        {<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"d"</span>, <span class="string">"e"</span>},</span><br/><span class="line">        {<span class="string">"b"</span>, <span class="string">"c"</span>, <span class="string">"d"</span>},</span><br/><span class="line">        {<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"d"</span>, <span class="string">"e"</span>},</span><br/><span class="line">        {<span class="string">"a"</span>, <span class="string">"c"</span>, <span class="string">"d"</span>, <span class="string">"e"</span>},</span><br/><span class="line">        {<span class="string">"b"</span>, <span class="string">"c"</span>, <span class="string">"d"</span>, <span class="string">"e"</span>},</span><br/><span class="line">        {<span class="string">"b"</span>, <span class="string">"d"</span>, <span class="string">"e"</span>},</span><br/><span class="line">        {<span class="string">"c"</span>, <span class="string">"d"</span>},</span><br/><span class="line">        {<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>},</span><br/><span class="line">        {<span class="string">"a"</span>, <span class="string">"d"</span>, <span class="string">"e"</span>},</span><br/><span class="line">        {<span class="string">"b"</span>, <span class="string">"d"</span>},</span><br/><span class="line">    ]</span><br/><span class="line"></span><br/><span class="line">    te = TransactionEncoder()</span><br/><span class="line">    item_array = te.fit(itemSetList).transform(itemSetList)</span><br/><span class="line">    df = pd.DataFrame(item_array)</span><br/><span class="line"></span><br/><span class="line">    res = apriori(df, min_support=<span class="number">0.3</span>)</span><br/><span class="line">    <span class="built_in">print</span>(res)</span><br/></pre></td></tr></table></figure>
</div>
<footer class="post-footer">
<div class="post-nav">
<div class="post-nav-item">
<a href="/blog/myclock.html" rel="prev" title="用C语言模拟一个像素时钟">
<i class="fa fa-chevron-left"></i> 用C语言模拟一个像素时钟
                </a>
</div>
<div class="post-nav-item">
<a href="/blog/joke.html" rel="next" title="笑话原理研究">
                  笑话原理研究 <i class="fa fa-chevron-right"></i>
</a>
</div>
</div>
</footer>
</article>
</div>
</div>
</main>
<footer class="footer">
<div class="footer-inner">
<div class="copyright">
  2023 – 
  <span itemprop="copyrightYear">2024</span>
<span class="with-love">
<i class="fa fa-heart"></i>
</span>
<span class="author" itemprop="copyrightHolder">Ruofan</span>
</div>
</div>
</footer>
<div aria-label="返回顶部" class="back-to-top" role="button">
<i class="fa fa-arrow-up fa-lg"></i>
<span>0%</span>
</div>
<div class="reading-progress-bar"></div>
<noscript>
<div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>
<script crossorigin="anonymous" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
<script crossorigin="anonymous" integrity="sha256-j+yj56cdEY2CwkVtGyz18fNybFGpMGJ8JxG3GSyO2+I=" src="https://cdnjs.cloudflare.com/ajax/libs/pangu/4.0.7/pangu.min.js"></script>
<script src="/blog/js/comments.js"></script><script src="/blog/js/utils.js"></script><script src="/blog/js/next-boot.js"></script>
<script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"default","dark":"dark"},"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/9.4.3/mermaid.min.js","integrity":"sha256-e0o3JYsdjqKajf9eOe22FhioYSz9WofRY4dLKo3F6do="}}</script>
<script src="/blog/js/third-party/tags/mermaid.js"></script>
<script class="next-config" data-name="enableMath" type="application/json">false</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/blog/js/third-party/math/mathjax.js"></script>
<script crossorigin="anonymous" integrity="sha256-yvJQOINiH9fWemHn0vCA5lsHWJaHs6/ZmO+1Ft04SvM=" src="https://cdnjs.cloudflare.com/ajax/libs/quicklink/2.3.0/quicklink.umd.js"></script>
<script class="next-config" data-name="quicklink" type="application/json">{"enable":true,"home":true,"archive":false,"delay":true,"timeout":3000,"priority":true,"url":"https://hrfis.me/blog/ds.html"}</script>
<script src="/blog/js/third-party/quicklink.js"></script>
</body>
</html>
