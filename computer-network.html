<!DOCTYPE html>

<html lang="zh-CN">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width" name="viewport"/>
<meta content="#222" name="theme-color"/><meta content="Hexo 6.3.0" name="generator"/>
<link href="/blog/css/main.css" rel="stylesheet"/>
<link crossorigin="anonymous" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" rel="stylesheet"/>
<script class="next-config" data-name="main" type="application/json">{"hostname":"hrfis.me","root":"/blog/","images":"/blog/images","scheme":"Gemini","darkmode":false,"version":"8.16.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"flat"},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":true,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":false,"async":true,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","sidebar":"fadeInLeft"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/blog/js/config.js"></script>
<meta content="永远不看系列。" name="description"/>
<meta content="article" property="og:type"/>
<meta content="计算机网络" property="og:title"/>
<meta content="https://hrfis.me/blog/computer-network.html" property="og:url"/>
<meta content="若凡的笔记" property="og:site_name"/>
<meta content="永远不看系列。" property="og:description"/>
<meta content="zh_CN" property="og:locale"/>
<meta content="2023-09-06T08:30:00.000Z" property="article:published_time"/>
<meta content="2024-04-28T09:50:58.220Z" property="article:modified_time"/>
<meta content="Ruofan" property="article:author"/>
<meta content="summary" name="twitter:card"/>
<link href="https://hrfis.me/blog/computer-network" rel="canonical"/>
<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://hrfis.me/blog/computer-network.html","path":"/computer-network.html","title":"计算机网络"}</script>
<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>计算机网络 | 若凡的笔记</title>
<noscript>
<link href="/blog/css/noscript.css" rel="stylesheet"/>
</noscript>
</head>
<body itemscope="" itemtype="http://schema.org/WebPage">
<div class="headband"></div>
<main class="main">
<div class="column">
<header class="header" itemscope="" itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
<div class="site-nav-toggle">
<div aria-label="切换导航栏" class="toggle" role="button">
<span class="toggle-line"></span>
<span class="toggle-line"></span>
<span class="toggle-line"></span>
</div>
</div>
<div class="site-meta">
<a class="brand" href="/blog/" rel="start">
<i class="logo-line"></i>
<p class="site-title">若凡的笔记</p>
<i class="logo-line"></i>
</a>
</div>
<div class="site-nav-right">
<div aria-label="搜索" class="toggle popup-trigger" role="button">
</div>
</div>
</div>
<nav class="site-nav">
<ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/blog/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/blog/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li>
</ul>
</nav>
</header>
<aside class="sidebar">
<div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
<ul class="sidebar-nav">
<li class="sidebar-nav-toc">
          文章目录
        </li>
<li class="sidebar-nav-overview">
          站点概览
        </li>
</ul>
<div class="sidebar-panel-container">
<!--noindex-->
<div class="post-toc-wrap sidebar-panel">
<div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A6%82%E8%BF%B0"><span class="nav-number">1.</span> <span class="nav-text">概述</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#isp"><span class="nav-number">1.1.</span> <span class="nav-text">ISP</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ixp"><span class="nav-number">1.2.</span> <span class="nav-text">IXP</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#rfc-%E6%96%87%E6%A1%A3"><span class="nav-number">1.3.</span> <span class="nav-text">RFC 文档</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BE%B9%E7%BC%98%E9%83%A8%E5%88%86%E7%9A%84%E9%80%9A%E4%BF%A1"><span class="nav-number">1.4.</span> <span class="nav-text">边缘部分的通信</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#cs"><span class="nav-number">1.4.1.</span> <span class="nav-text">C/S</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#p2p"><span class="nav-number">1.4.2.</span> <span class="nav-text">P2P</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A0%B8%E5%BF%83%E9%83%A8%E5%88%86%E7%9A%84%E9%80%9A%E4%BF%A1"><span class="nav-number">1.5.</span> <span class="nav-text">核心部分的通信</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%94%B5%E8%B7%AF%E4%BA%A4%E6%8D%A2"><span class="nav-number">1.5.1.</span> <span class="nav-text">电路交换</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E7%BB%84%E4%BA%A4%E6%8D%A2"><span class="nav-number">1.5.2.</span> <span class="nav-text">分组交换</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8A%A5%E6%96%87%E4%BA%A4%E6%8D%A2"><span class="nav-number">1.5.3.</span> <span class="nav-text">报文交换</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%B1%BB%E5%88%AB"><span class="nav-number">1.6.</span> <span class="nav-text">类别</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8C%89%E4%BD%9C%E7%94%A8%E8%8C%83%E5%9B%B4"><span class="nav-number">1.6.1.</span> <span class="nav-text">按作用范围</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8C%89%E4%BD%BF%E7%94%A8%E8%80%85"><span class="nav-number">1.6.2.</span> <span class="nav-text">按使用者</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8E%A5%E5%85%A5%E7%BD%91-an"><span class="nav-number">1.6.3.</span> <span class="nav-text">接入网 AN</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%80%A7%E8%83%BD%E6%8C%87%E6%A0%87"><span class="nav-number">2.</span> <span class="nav-text">性能指标</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#mathrmkmg...-%E7%9A%84%E4%B8%8D%E5%90%8C%E5%90%AB%E4%B9%89"><span class="nav-number">2.1.</span> <span class="nav-text">\(\mathrm{K,M,G...}\) 的不同含义</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%9F%E7%8E%87"><span class="nav-number">2.2.</span> <span class="nav-text">速率</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B8%A6%E5%AE%BD"><span class="nav-number">2.3.</span> <span class="nav-text">带宽</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%A2%91%E5%9F%9F%E4%B8%8A%E7%9A%84mathrmhz"><span class="nav-number">2.3.1.</span> <span class="nav-text">频域上的：\(\mathrm{Hz}\)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%97%B6%E5%9F%9F%E4%B8%8A%E7%9A%84mathrmbits"><span class="nav-number">2.3.2.</span> <span class="nav-text">时域上的：\(\mathrm{bit/s}\)</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%9E%E5%90%90%E9%87%8F"><span class="nav-number">2.4.</span> <span class="nav-text">吞吐量</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%97%B6%E5%BB%B6"><span class="nav-number">2.5.</span> <span class="nav-text">时延</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%91%E9%80%81%E6%97%B6%E5%BB%B6"><span class="nav-number">2.5.1.</span> <span class="nav-text">发送时延</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BC%A0%E6%92%AD%E6%97%B6%E5%BB%B6"><span class="nav-number">2.5.2.</span> <span class="nav-text">传播时延</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A4%84%E7%90%86%E6%97%B6%E5%BB%B6"><span class="nav-number">2.5.3.</span> <span class="nav-text">处理时延</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8E%92%E9%98%9F%E6%97%B6%E5%BB%B6"><span class="nav-number">2.5.4.</span> <span class="nav-text">排队时延</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BF%87%E7%A8%8B"><span class="nav-number">2.5.5.</span> <span class="nav-text">过程</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%97%B6%E5%BB%B6%E5%B8%A6%E5%AE%BD%E7%A7%AF"><span class="nav-number">2.6.</span> <span class="nav-text">时延带宽积</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AF%8F%E6%AF%94%E7%89%B9%E5%AE%BD%E5%BA%A6"><span class="nav-number">2.7.</span> <span class="nav-text">每比特宽度</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#rtt"><span class="nav-number">2.8.</span> <span class="nav-text">RTT</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9C%89%E6%95%88%E6%95%B0%E6%8D%AE%E7%8E%87"><span class="nav-number">2.9.</span> <span class="nav-text">有效数据率</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%A9%E7%94%A8%E7%8E%87"><span class="nav-number">2.10.</span> <span class="nav-text">利用率</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84"><span class="nav-number">3.</span> <span class="nav-text">体系结构</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E8%A1%A8"><span class="nav-number">3.1.</span> <span class="nav-text">体系结构表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#pdu"><span class="nav-number">3.2.</span> <span class="nav-text">PDU</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE%E7%9A%84%E4%B8%89%E8%A6%81%E7%B4%A0"><span class="nav-number">3.3.</span> <span class="nav-text">网络协议的三要素</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%89%A9%E7%90%86%E5%B1%82%E4%B9%8B%E4%B8%8B%E7%9A%84%E4%BC%A0%E8%BE%93%E5%AA%92%E4%BD%93"><span class="nav-number">3.4.</span> <span class="nav-text">物理层之下的传输媒体</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%89%A9%E7%90%86%E5%B1%82"><span class="nav-number">4.</span> <span class="nav-text">物理层</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%89%B9%E6%80%A7"><span class="nav-number">4.1.</span> <span class="nav-text">特性</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9C%BA%E6%A2%B0%E7%89%B9%E6%80%A7"><span class="nav-number">4.1.1.</span> <span class="nav-text">机械特性</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%94%B5%E6%B0%94%E7%89%B9%E6%80%A7"><span class="nav-number">4.1.2.</span> <span class="nav-text">电气特性</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8A%9F%E8%83%BD%E7%89%B9%E6%80%A7"><span class="nav-number">4.1.3.</span> <span class="nav-text">功能特性</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BF%87%E7%A8%8B%E7%89%B9%E6%80%A7"><span class="nav-number">4.1.4.</span> <span class="nav-text">过程特性</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%9A%E4%BF%A1%E5%8F%8C%E6%96%B9%E7%9A%84%E4%BA%A4%E4%BA%92%E6%96%B9%E5%BC%8F"><span class="nav-number">4.2.</span> <span class="nav-text">通信双方的交互方式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8D%95%E5%90%91%E9%80%9A%E4%BF%A1%E5%8D%95%E5%B7%A5"><span class="nav-number">4.2.1.</span> <span class="nav-text">单向通信（单工）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%8C%E5%90%91%E4%BA%A4%E6%9B%BF%E9%80%9A%E4%BF%A1%E5%8D%8A%E5%8F%8C%E5%B7%A5"><span class="nav-number">4.2.2.</span> <span class="nav-text">双向交替通信（半双工）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%8C%E5%90%91%E5%90%8C%E6%97%B6%E9%80%9A%E4%BF%A1%E5%85%A8%E5%8F%8C%E5%B7%A5"><span class="nav-number">4.2.3.</span> <span class="nav-text">双向同时通信（全双工）</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BC%96%E7%A0%81%E5%92%8C%E8%B0%83%E5%88%B6"><span class="nav-number">4.3.</span> <span class="nav-text">编码和调制</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9E%81%E6%80%A7%E4%B8%8D%E5%BD%92%E9%9B%B6%E7%94%B5%E5%B9%B3polar-nrzl"><span class="nav-number">4.3.1.</span> <span class="nav-text">极性不归零电平（Polar NRZL）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9E%81%E6%80%A7%E4%B8%8D%E5%BD%92%E9%9B%B6%E5%8F%8D%E8%BD%ACpolar-nrzi"><span class="nav-number">4.3.2.</span> <span class="nav-text">极性不归零反转（Polar NRZI）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9E%81%E6%80%A7%E5%BD%92%E9%9B%B6polar-rz"><span class="nav-number">4.3.3.</span> <span class="nav-text">极性归零（Polar RZ）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9B%BC%E5%BD%BB%E6%96%AF%E7%89%B9%E7%BC%96%E7%A0%81"><span class="nav-number">4.3.4.</span> <span class="nav-text">曼彻斯特编码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B7%AE%E5%88%86%E6%9B%BC%E5%BD%BB%E6%96%AF%E7%89%B9%E7%BC%96%E7%A0%81"><span class="nav-number">4.3.5.</span> <span class="nav-text">差分曼彻斯特编码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AF%B9%E6%AF%94"><span class="nav-number">4.3.6.</span> <span class="nav-text">对比</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9F%BA%E5%B8%A6%E8%B0%83%E5%88%B6"><span class="nav-number">4.3.7.</span> <span class="nav-text">基带调制</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B8%A6%E9%80%9A%E8%B0%83%E5%88%B6"><span class="nav-number">4.3.8.</span> <span class="nav-text">带通调制</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%AD%A3%E4%BA%A4%E6%8C%AF%E5%B9%85%E8%B0%83%E5%88%B6qam"><span class="nav-number">4.3.9.</span> <span class="nav-text">正交振幅调制（QAM）</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%9A%E4%BF%A1%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5"><span class="nav-number">4.4.</span> <span class="nav-text">通信基础概念</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%A0%81%E5%85%83"><span class="nav-number">4.4.1.</span> <span class="nav-text">码元</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A5%88%E6%B0%8F%E5%87%86%E5%88%99%E5%A5%88%E5%A5%8E%E6%96%AF%E7%89%B9%E9%A6%99%E5%86%9C%E9%87%87%E6%A0%B7%E5%AE%9A%E7%90%86%E7%9A%84%E4%B8%80%E9%83%A8%E5%88%86"><span class="nav-number">4.4.2.</span> <span class="nav-text">奈氏准则（奈奎斯特—香农采样定理的一部分）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BF%A1%E5%99%AA%E6%AF%94"><span class="nav-number">4.4.3.</span> <span class="nav-text">信噪比</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%A6%99%E5%86%9C%E5%85%AC%E5%BC%8F%E9%A6%99%E5%86%9C%E5%93%88%E7%89%B9%E8%8E%B1%E5%AE%B9%E9%87%8F%E5%AE%9A%E7%90%86"><span class="nav-number">4.4.4.</span> <span class="nav-text">香农公式（香农—哈特莱容量定理）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A5%88%E6%B0%8F%E5%87%86%E5%88%99%E5%92%8C%E9%A6%99%E5%86%9C%E5%85%AC%E5%BC%8F%E7%9A%84%E6%84%8F%E4%B9%89"><span class="nav-number">4.4.5.</span> <span class="nav-text">奈氏准则和香农公式的意义</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BF%A1%E9%81%93%E5%A4%8D%E7%94%A8"><span class="nav-number">4.4.6.</span> <span class="nav-text">信道复用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%A2%91%E5%88%86%E5%A4%8D%E7%94%A8fdm"><span class="nav-number">4.4.7.</span> <span class="nav-text">频分复用（FDM）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%97%B6%E5%88%86%E5%A4%8D%E7%94%A8tdm"><span class="nav-number">4.4.8.</span> <span class="nav-text">时分复用（TDM）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%9F%E8%AE%A1%E6%97%B6%E5%88%86%E5%A4%8D%E7%94%A8stdm"><span class="nav-number">4.4.9.</span> <span class="nav-text">统计时分复用（STDM）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B3%A2%E5%88%86%E5%A4%8D%E7%94%A8wdm"><span class="nav-number">4.4.10.</span> <span class="nav-text">波分复用（WDM）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%A0%81%E5%88%86%E5%A4%8D%E7%94%A8cdm"><span class="nav-number">4.4.11.</span> <span class="nav-text">码分复用（CDM）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%A2%91%E5%88%86%E5%A4%9A%E5%9D%80%E6%97%B6%E5%88%86%E5%A4%9A%E5%9D%80%E7%A0%81%E5%88%86%E5%A4%9A%E5%9D%80fdmatdmacdma"><span class="nav-number">4.4.12.</span> <span class="nav-text">频分多址/时分多址/码分多址（FDMA/TDMA/CDMA）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE"><span class="nav-number">4.4.13.</span> <span class="nav-text">题目</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E9%93%BE%E8%B7%AF%E5%B1%82"><span class="nav-number">5.</span> <span class="nav-text">数据链路层</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%81%E8%A3%85%E6%88%90%E5%B8%A7"><span class="nav-number">5.1.</span> <span class="nav-text">封装成帧</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B8%A7%E5%AE%9A%E7%95%8C%E7%AC%A6"><span class="nav-number">5.1.1.</span> <span class="nav-text">帧定界符</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%8F%E6%98%8E%E4%BC%A0%E8%BE%93"><span class="nav-number">5.2.</span> <span class="nav-text">透明传输</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BD%AC%E4%B9%89%E5%AD%97%E7%AC%A6"><span class="nav-number">5.2.1.</span> <span class="nav-text">转义字符</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B7%AE%E9%94%99%E6%A3%80%E6%B5%8B"><span class="nav-number">5.3.</span> <span class="nav-text">差错检测</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AF%AF%E7%A0%81%E7%8E%87ber"><span class="nav-number">5.3.1.</span> <span class="nav-text">误码率（BER）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B8%A7%E6%A3%80%E9%AA%8C%E5%BA%8F%E5%88%97fcs"><span class="nav-number">5.3.2.</span> <span class="nav-text">帧检验序列（FCS）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BE%AA%E7%8E%AF%E5%86%97%E4%BD%99%E6%A3%80%E9%AA%8Ccrc"><span class="nav-number">5.3.3.</span> <span class="nav-text">循环冗余检验（CRC）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%97%A0%E6%AF%94%E7%89%B9%E5%B7%AE%E9%94%99%E4%B8%8E%E6%97%A0%E4%BC%A0%E8%BE%93%E5%B7%AE%E9%94%99"><span class="nav-number">5.3.4.</span> <span class="nav-text">无比特差错与无传输差错</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%82%B9%E5%AF%B9%E7%82%B9%E5%8D%8F%E8%AE%AEppp"><span class="nav-number">5.4.</span> <span class="nav-text">点对点协议PPP</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ppp-%E5%8D%8F%E8%AE%AE%E7%9A%84%E5%B7%A5%E4%BD%9C%E7%8A%B6%E6%80%81"><span class="nav-number">5.4.1.</span> <span class="nav-text">PPP 协议的工作状态</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ppp-%E5%B8%A7%E6%A0%BC%E5%BC%8F"><span class="nav-number">5.4.2.</span> <span class="nav-text">PPP 帧格式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BC%82%E6%AD%A5%E4%BC%A0%E8%BE%93%E6%97%B6%E7%9A%84%E5%AD%97%E8%8A%82%E5%A1%AB%E5%85%85"><span class="nav-number">5.4.3.</span> <span class="nav-text">异步传输时的字节填充</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%90%8C%E6%AD%A5%E4%BC%A0%E8%BE%93%E6%97%B6%E7%9A%84%E9%9B%B6%E6%AF%94%E7%89%B9%E5%A1%AB%E5%85%85"><span class="nav-number">5.4.4.</span> <span class="nav-text">同步传输时的零比特填充</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%A6%E5%A4%96"><span class="nav-number">5.4.5.</span> <span class="nav-text">另外</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#csmacd-%E5%8D%8F%E8%AE%AE"><span class="nav-number">5.5.</span> <span class="nav-text">CSMA／CD 协议</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%90%8D%E8%AF%8D%E8%BE%A8%E6%9E%90csma-%E4%B8%8E-cdma"><span class="nav-number">5.5.1.</span> <span class="nav-text">名词辨析：CSMA 与 CDMA</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#csmacd-%E5%8D%8F%E8%AE%AE%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B"><span class="nav-number">5.5.2.</span> <span class="nav-text">CSMA/CD 协议工作流程</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%A2%B0%E6%92%9E"><span class="nav-number">5.5.3.</span> <span class="nav-text">碰撞</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BC%BA%E5%8C%96%E7%A2%B0%E6%92%9E"><span class="nav-number">5.5.4.</span> <span class="nav-text">强化碰撞</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%88%AA%E6%96%AD%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%8C%87%E6%95%B0%E9%80%80%E9%81%BF"><span class="nav-number">5.5.5.</span> <span class="nav-text">截断二进制指数退避</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%A5%E5%A4%AA%E7%BD%91%E7%9A%84%E4%BF%A1%E9%81%93%E5%88%A9%E7%94%A8%E7%8E%87"><span class="nav-number">5.6.</span> <span class="nav-text">以太网的信道利用率</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BE%8B%E9%A2%98"><span class="nav-number">5.7.</span> <span class="nav-text">例题</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#section"><span class="nav-number">5.7.1.</span> <span class="nav-text">【3-24】</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#section-1"><span class="nav-number">5.7.2.</span> <span class="nav-text">【3-25】</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%A5%E5%A4%AA%E7%BD%91"><span class="nav-number">5.8.</span> <span class="nav-text">以太网</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#windows-%E4%B8%8B%E7%94%A8-cmd-%E6%9F%A5%E7%9C%8B%E7%BD%91%E7%BB%9C%E9%80%82%E9%85%8D%E5%99%A8%E7%9A%84-mac-%E5%9C%B0%E5%9D%80"><span class="nav-number">5.9.</span> <span class="nav-text">Windows 下用 cmd
查看网络适配器的 MAC 地址</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#mac-%E5%9C%B0%E5%9D%80"><span class="nav-number">5.10.</span> <span class="nav-text">MAC 地址</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%A5%E5%A4%AA%E7%BD%91-v2-%E7%9A%84-mac-%E5%B8%A7%E6%A0%BC%E5%BC%8F"><span class="nav-number">5.11.</span> <span class="nav-text">以太网 V2 的 MAC 帧格式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9B%86%E7%BA%BF%E5%99%A8%E4%B8%8E%E4%BA%A4%E6%8D%A2%E6%9C%BA"><span class="nav-number">5.12.</span> <span class="nav-text">集线器与交换机</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%A5%E5%A4%AA%E7%BD%91%E4%BA%A4%E6%8D%A2%E6%9C%BA%E7%9A%84%E8%87%AA%E5%AD%A6%E4%B9%A0%E5%8A%9F%E8%83%BD"><span class="nav-number">5.13.</span> <span class="nav-text">以太网交换机的自学习功能</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#base-t-%E4%BB%A5%E5%A4%AA%E7%BD%91"><span class="nav-number">5.14.</span> <span class="nav-text">100BASE-T 以太网</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BD%91%E7%BB%9C%E5%B1%82"><span class="nav-number">6.</span> <span class="nav-text">网络层</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%A4%E7%A7%8D%E6%9C%8D%E5%8A%A1"><span class="nav-number">6.1.</span> <span class="nav-text">两种服务</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%A4%E4%B8%AA%E5%B1%82%E9%9D%A2"><span class="nav-number">6.2.</span> <span class="nav-text">两个层面</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B7%AF%E7%94%B1%E8%A1%A8%E5%92%8C%E8%BD%AC%E5%8F%91%E8%A1%A8"><span class="nav-number">6.3.</span> <span class="nav-text">路由表和转发表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ipv4"><span class="nav-number">6.4.</span> <span class="nav-text">IPv4</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%86%E7%B1%BB%E7%BC%96%E5%9D%80"><span class="nav-number">6.5.</span> <span class="nav-text">分类编址</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%97%A0%E5%88%86%E7%B1%BB%E7%BC%96%E5%9D%80-cidr"><span class="nav-number">6.6.</span> <span class="nav-text">无分类编址 CIDR</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ip-%E5%9C%B0%E5%9D%80%E5%92%8C-mac-%E5%9C%B0%E5%9D%80"><span class="nav-number">6.7.</span> <span class="nav-text">IP 地址和 MAC 地址</span></a></li></ol></li></ol></div>
</div>
<!--/noindex-->
<div class="site-overview-wrap sidebar-panel">
<div class="site-author animated" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<p class="site-author-name" itemprop="name">Ruofan</p>
<div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
<nav class="site-state">
<div class="site-state-item site-state-posts">
<a href="/blog/archives/">
<span class="site-state-item-count">35</span>
<span class="site-state-item-name">笔记</span>
</a>
</div>
<div class="site-state-item site-state-categories">
<a href="/blog/categories/">
<span class="site-state-item-count">4</span>
<span class="site-state-item-name">分类</span></a>
</div>
</nav>
</div>
</div>
</div>
</div>
</aside>
</div>
<div class="main-inner post posts-expand">
<div class="post-block">
<article class="post-content" itemscope="" itemtype="http://schema.org/Article" lang="zh-CN">
<link href="https://hrfis.me/blog/computer-network.html" itemprop="mainEntityOfPage"/>
<span hidden="" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
<meta content="/blog/images/avatar.gif" itemprop="image"/>
<meta content="Ruofan" itemprop="name"/>
</span>
<span hidden="" itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
<meta content="若凡的笔记" itemprop="name"/>
<meta content="" itemprop="description"/>
</span>
<span hidden="" itemprop="post" itemscope="" itemtype="http://schema.org/CreativeWork">
<meta content="计算机网络 | 若凡的笔记" itemprop="name"/>
<meta content="" itemprop="description"/>
</span>
<header class="post-header">
<h1 class="post-title" itemprop="name headline">
          计算机网络
        </h1>
<div class="post-meta-container">
<div class="post-meta">
<span class="post-meta-item">
<span class="post-meta-item-icon">
<i class="far fa-calendar"></i>
</span>
<span class="post-meta-item-text">发表于</span>
<time datetime="2023-09-06T16:30:00+08:00" itemprop="dateCreated datePublished" title="创建时间：2023-09-06 16:30:00">2023-09-06</time>
</span>
<span class="post-meta-item">
<span class="post-meta-item-icon">
<i class="far fa-calendar-check"></i>
</span>
<span class="post-meta-item-text">更新于</span>
<time datetime="2024-04-28T17:50:58+08:00" itemprop="dateModified" title="修改时间：2024-04-28 17:50:58">2024-04-28</time>
</span>
<span class="post-meta-item">
<span class="post-meta-item-icon">
<i class="far fa-folder"></i>
</span>
<span class="post-meta-item-text">分类于</span>
<span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
<a href="/blog/u/" itemprop="url" rel="index"><span itemprop="name">无分类</span></a>
</span>
</span>
</div>
</div>
</header>
<div class="post-body" itemprop="articleBody"><p>永远不看系列。</p>
<span id="more"></span>
<h2 id="概述">概述</h2>
<p>一些通用的、可编程的（含
CPU）硬件连接起来，可以传输多种不同类型的数据。</p>
<ul>
<li>互连网 internet：通用名词，一群计算机连起来。</li>
<li>互联网 Internet：专用名词，全球计算机连起来。</li>
</ul>
<p>世界上第一个网页：<a href="http://info.cern.ch" rel="noopener" target="_blank">http://info.cern.ch</a></p>
<h3 id="isp">ISP</h3>
<p>互联网服务提供者（Internet Service
Provider），可以是移动联通电信公司，也可以是非营利组织。</p>
<ul>
<li>主干 ISP：国</li>
<li>地区 ISP：省</li>
<li>本地 ISP：省以下</li>
</ul>
<p>内容提供者可以连接各级 ISP 和 IXP。</p>
<h3 id="ixp">IXP</h3>
<p>互联网交换点（Internet eXchange Point），让两个 ISP 直接相连。</p>
<p>比如两个同级 ISP 交换信息时，可以通过 IXP，而不必通过上级 ISP。</p>
<h3 id="rfc-文档">RFC 文档</h3>
<p>“请求评论”（Request For
Comments）的文档，公开发布的互联网建议标准，请求公众评论。</p>
<p>最后制定互联网标准 STD。</p>
<ul>
<li>边缘部分：所有用户直接使用的主机。又叫端系统。</li>
<li>核心部分：大量网络和连接网络的路由器。</li>
</ul>
<h3 id="边缘部分的通信">边缘部分的通信</h3>
<p>计算机通信，实际上是进程间通过端口号通信。</p>
<h4 id="cs">C/S</h4>
<p>客户-服务器</p>
<p>客户和服务器都是指进程。</p>
<h4 id="p2p">P2P</h4>
<p>peer to peer，peer：平等的。</p>
<p>本质是 C/S，每台主机既是 C 又是 S。</p>
<h3 id="核心部分的通信">核心部分的通信</h3>
<h4 id="电路交换">电路交换</h4>
<p>三步走：建立连接-&gt;占线通信-&gt;释放连接</p>
<ul>
<li>占线，两台机器间通信完了才能接受与其他机器通信</li>
<li>效率低（时间利用密度低，占线过程中会有不收发信息的时候）</li>
</ul>
<h4 id="分组交换">分组交换</h4>
<p>存储转发，类比快递收寄</p>
<ol type="1">
<li><p>把报文分组，每组写上头部信息。（包裹大包分成小包，写上序号、寄出地和目的地等）</p></li>
<li><p>通过路由器一级一级地转发到目的地。</p>
<pre class="mermaid">   gantt
    title 分组交换（甘特图）
    dateFormat s
    axisFormat %S

    section 1号包
    从A到B    :0, 5s
    从B到C    :5, 5s
    从C到D    :10, 5s

    section 2号包
    从A到B    :5, 5s
    从B到C    :10, 5s
    从C到D    :15, 5s

    section 3号包
    从A到B    :10, 5s
    从B到C    :15, 5s
    从C到D    :20, 5s</pre>
<ul>
<li>0-5 时间 1 号包裹从 A 站到 B 站</li>
<li>5-10 时间 1 号包裹从 B 站到 C 站、2 号包裹从 A 站到 B 站</li>
<li>10-15 时间 1 号包裹从 C 站到 D 站、2 号包裹从 B 站到 C 站、3
号包裹从 A 站到 B 站</li>
<li>……</li>
<li>（书上的图是以空间为横轴，以时间为纵轴）</li>
</ul></li>
<li><p>把各个包裹合并。</p>
<ul>
<li>不会占线，速度比报文交换快</li>
<li>排队等路由器转发</li>
<li>动态分配线路，不保证带宽</li>
<li>增加开销（合并的时候）</li>
</ul></li>
</ol>
<h4 id="报文交换">报文交换</h4>
<p>也是存储转发，但是不分组，直接发完整的。</p>
<h3 id="类别">类别</h3>
<h4 id="按作用范围">按作用范围</h4>
<ul>
<li>WAN：广域网，几十到几千公里</li>
<li>MAN：城域网，5~50km</li>
<li>LAN：局域网，1km</li>
<li>PAN：个人局域网，10m</li>
</ul>
<h4 id="按使用者">按使用者</h4>
<ul>
<li>公用网</li>
<li>专用网</li>
</ul>
<h4 id="接入网-an">接入网 AN</h4>
<p>不是核心部分，也不是边缘部分。</p>
<h2 id="性能指标">性能指标</h2>
<ul>
<li><span class="math inline">\(\mathrm{K,M,G...}\)</span>
的不同含义</li>
<li>速率、带宽、吞吐量</li>
<li>发送时延、传播时延、处理时延、排队时延</li>
<li>时延带宽积</li>
<li>每比特宽度</li>
<li>RTT 和有效数据（速）率</li>
<li>（网络）利用率</li>
</ul>
<h3 id="mathrmkmg...-的不同含义"><span class="math inline">\(\mathrm{K,M,G...}\)</span> 的不同含义</h3>
<p>基数不同：</p>
<ul>
<li>在计算机领域，<span class="math inline">\(\mathrm{K =
2^{10}}\)</span>，<span class="math inline">\(\mathrm{M =
2^{10}K}\)</span>……</li>
<li>在通信的领域，<span class="math inline">\(\mathrm{K =
10^{3}}\)</span>，<span class="math inline">\(\mathrm{M =
10^{3}K}\)</span>……</li>
</ul>
<p>数据通过网线或空气传播时，是在通信的领域。</p>
<p>一般 <span class="math inline">\(\mathrm{MB}\)</span> 指 <span class="math inline">\(\mathrm{2^{10} \times 2^{10} \times 8
bit}\)</span>，</p>
<p><span class="math inline">\(\mathrm{Mbit}\)</span> 指 <span class="math inline">\(\mathrm{10^{3} \times 10^{3} bit}\)</span>，</p>
<p>具体问题具体分析。如果追求准确的话，<span class="math inline">\(\mathrm{2^{10} \times 2^{10} \times 8
bit}\)</span> 用 <span class="math inline">\(\mathrm{MiB}\)</span>
表示。</p>
<h3 id="速率">速率</h3>
<p><span class="math inline">\(\mathrm{bit/s}\)</span></p>
<p><strong>通常</strong>指额定速率。</p>
<h3 id="带宽">带宽</h3>
<h4 id="频域上的mathrmhz">频域上的：<span class="math inline">\(\mathrm{Hz}\)</span></h4>
<p>信号频率范围 <span class="math inline">\(\mathrm{200Hz \sim
300Hz}\)</span>，</p>
<p>带宽为 <span class="math inline">\(\mathrm{300Hz - 200Hz =
100Hz}\)</span>。</p>
<h4 id="时域上的mathrmbits">时域上的：<span class="math inline">\(\mathrm{bit/s}\)</span></h4>
<p><strong>通常</strong>指某信道的最高速率。</p>
<h3 id="吞吐量">吞吐量</h3>
<p>指实际速率 <span class="math inline">\(\mathrm{bit/s}\)</span>，进量
+ 出量。</p>
<p>有多条链路时，吞吐量由瓶颈链路决定。</p>
<h3 id="时延">时延</h3>
<p>单位都是时间单位。</p>
<h4 id="发送时延">发送时延</h4>
<p>网卡发送数据的时间。<strong>与信道长度无关</strong>。不要使用【传输时延】这个词。</p>
<p><span class="math inline">\(\mathrm{s = \dfrac{bit}{bit/s}} =
\dfrac{数据长度}{发送速率}\)</span></p>
<h4 id="传播时延">传播时延</h4>
<p>电磁波在网线或空气中传播的时间。<strong>与信道长度有关</strong>。</p>
<p><span class="math inline">\(\mathrm{s = \dfrac{m}{m/s} =
\dfrac{信道长度}{信号传播速率}}\)</span></p>
<ul>
<li>光速：<span class="math inline">\(\mathrm{3.0 \times 10^5
km/s}\)</span></li>
<li>铜线：<span class="math inline">\(\mathrm{2.3 \times 10^5
km/s}\)</span></li>
<li>光纤：<span class="math inline">\(\mathrm{2.0 \times 10^5
km/s}\)</span></li>
</ul>
<p>发送时延和传播时延没啥关系。</p>
<h4 id="处理时延">处理时延</h4>
<p>主机或路由器收到分组后，对分组进行处理的时间。</p>
<h4 id="排队时延">排队时延</h4>
<p>分组在路由器输入队列和输出队列里排队的时间。</p>
<h4 id="过程">过程</h4>
<p>……-&gt;输出排队-&gt;发送-&gt;传播-&gt;输入排队-&gt;处理-&gt;输出排队……</p>
<h3 id="时延带宽积">时延带宽积</h3>
<p><span class="math inline">\(\mathrm{bit = s \times bit/s = 传播时延
\times 带宽}\)</span></p>
<p>已经从发送端发出，但尚未到达接收端的比特数。又叫<strong>以比特为单位的链路长度</strong>。</p>
<h3 id="每比特宽度">每比特宽度</h3>
<p>（两行式子都存疑）</p>
<p><span class="math display">\[
\begin{aligned}
&amp;\mathrm{m/bit = \dfrac{m}{bit} = \dfrac{信道长}{比特数}} \\
&amp;\mathrm{m/bit = \dfrac{m/s}{bit/s} =
\dfrac{信道传播速率}{信道当前带宽（或者网卡发送速率？）}}
\end{aligned}
\]</span></p>
<h3 id="rtt">RTT</h3>
<p>往返时间（Round-Trip Time）</p>
<pre class="mermaid">gantt
    title RTT（甘特图）
    dateFormat s
    axisFormat %S

    section RTT
    RTT :3,17s

    section A
    发送           :0,3s
    接收    :17,3s
    ……    :20,4s

    section 传播
    从A到B传播    :1,8s
    从B到A传播    :11,8s

    section B
    接收      :7,3s
    发送    :10,3s</pre>
<p>其中排队时间和处理时间在接收和发送之间，这里忽略了。</p>
<h3 id="有效数据率">有效数据率</h3>
<p><span class="math inline">\(\mathrm{bit/s = \dfrac{bit}{s} =
\dfrac{数据长度}{发送时间+RTT}}\)</span></p>
<p>是有效的数据<strong>速率</strong>。</p>
<h3 id="利用率">利用率</h3>
<p><span class="math inline">\(网络利用率 = 1 -
\dfrac{空闲时延}{当前时延}\)</span></p>
<p>利用率越高，当前时延越大（堵车）。</p>
<h2 id="体系结构">体系结构</h2>
<h3 id="体系结构表">体系结构表</h3>
<table>
<tr>
<td>
应用层
</td>
<td rowspan="3">
应用层
</td>
<td rowspan="3">
应用层
</td>
<td rowspan="3">
HTTP FTP SMTP DNS POP SSH TLS/SSL……
</td>
<td>
……
</td>
</tr>
<tr>
<td>
表示层（语法层）
</td>
<td>
数据格式转换、字符编码、压缩、加解密、序列化
</td>
</tr>
<tr>
<td>
会话层
</td>
<td>
创建、管理和维护会话
</td>
</tr>
<tr>
<td>
传输层
</td>
<td>
传输层
</td>
<td>
传输层
</td>
<td>
TCP UDP……
</td>
<td>
自下而上第一个提供<b>端到端</b>的服务。UDP提供无连接不可靠的数据报服务。TCP提供有连接<b>可靠</b>的数据报服务
</td>
</tr>
<tr>
<td>
网络层
</td>
<td>
网络层
</td>
<td>
网络层
</td>
<td>
IP ARP……
</td>
<td>
路由选择。提供无连接不可靠的数据报服务
</td>
</tr>
<tr>
<td>
数据链路层
</td>
<td rowspan="2">
链路层
</td>
<td>
数据链路层
</td>
<td rowspan="2">
ARQ HDLC PPP……
</td>
<td>
差错控制（循环冗余校验CRC、帧检验序列FCS、海明码、 奇偶校验……）
点对点的流量控制
</td>
</tr>
<tr>
<td>
物理层
</td>
<td>
物理层
</td>
<td>
讨论用多大的电压表示0和1，比特如何在空气中传播
</td>
</tr>
<tr>
<th>
OSI
</th>
<th>
TCP/IP
</th>
<th>
教学模型
</th>
<th>
协议
</th>
<th>
任务
</th>
</tr>
</table>
<p>在网络体系结构中，<strong>不包含协议的内部实现细节</strong>。只是一个框架。</p>
<h3 id="pdu">PDU</h3>
<p>Protocol Data Unit，协议数据单元。</p>
<p>每一层的协议把数据封装成不同的 PDU。</p>
<h3 id="网络协议的三要素">网络协议的三要素</h3>
<ul>
<li>语法：数据的结构、格式、编码方式
<ul>
<li>HTTP 协议中的请求和响应消息的格式</li>
<li>TCP 协议中的数据包格式</li>
</ul></li>
<li>语义：数据的含义、解释，在传输过程中的意义和目的
<ul>
<li>HTTP 协议中的请求和响应消息的含义</li>
<li>TCP 协议中的数据包序列号</li>
</ul></li>
<li>同步：数据传输的时序
<ul>
<li>TCP 协议中的流量控制和拥塞控制</li>
</ul></li>
</ul>
<h3 id="物理层之下的传输媒体">物理层之下的传输媒体</h3>
<p><strong>不在体系结构之内。</strong> 或者说第 0 层。</p>
<ul>
<li>导引性传输媒体
<ul>
<li>双绞线（网线）</li>
<li>光缆：给光纤加上保护套，里面还填充了其他东西。
<ul>
<li>单模光纤：非常细，光传输时不会发生多次反射。适用于长距离、高速数据传输。</li>
<li>多模光纤：适用于短距离数据传输。</li>
</ul></li>
<li>同轴电缆</li>
<li>架空明线</li>
</ul></li>
<li>非导引性传输媒体
<ul>
<li>自由空间，空气或真空。
<ul>
<li>多径效应</li>
<li>微波接力</li>
</ul></li>
</ul></li>
</ul>
<h2 id="物理层">物理层</h2>
<p>物理层讨论的是如何传比特的，用什么协议（或者规程，两个名词一个意思）。不解释比特的意思。</p>
<p>它尽量隔开了传输媒体（铜线、光纤等）和上一层（数据链路层）之间的关系。</p>
<p>物理层确定了<strong>与传输媒体接口有关的一些特性：</strong></p>
<h3 id="特性">特性</h3>
<h4 id="机械特性">机械特性</h4>
<p>接线器的形状与尺寸、引脚数目和排列方式、固定和锁定装置等。</p>
<h4 id="电气特性">电气特性</h4>
<p>电压、电流、电阻、电容、电感、阻抗、信号速率等。</p>
<p>指明各条导线上的电压范围。</p>
<h4 id="功能特性">功能特性</h4>
<p><strong>数据传输的方式</strong></p>
<p>串行或并行</p>
<p><strong>编码方式</strong></p>
<p>指明某条导线上某一电平的电压的意义。或者说，指明 0，1
分别用哪个范围内的电压表示。即 <strong>比特 &lt;-&gt; 电压</strong>
的对应关系。</p>
<h4 id="过程特性">过程特性</h4>
<p>事件顺序，流程。</p>
<ul>
<li>通信双方的交互方式：单向通信、双向交替通信、双向同时通信</li>
<li>编码和调制</li>
<li>编码方式：极性不归零电平（Polar NRZL）、极性不归零反转（Polar
NRZI）、极性归零（Polar RZ）、曼彻斯特编码、差分曼彻斯特编码</li>
<li>基带调制、带通调制、正交振幅调制（QAM）</li>
</ul>
<!--more-->
<h3 id="通信双方的交互方式">通信双方的交互方式</h3>
<h4 id="单向通信单工">单向通信（单工）</h4>
<p>一段单行道。电视、广播。</p>
<h4 id="双向交替通信半双工">双向交替通信（半双工）</h4>
<p>一段有两个车道的马路，但是规定在一边的车道有车正在走时，另一边（相反方向）的车道不能有车走。对讲机。</p>
<h4 id="双向同时通信全双工">双向同时通信（全双工）</h4>
<p>一段正常的两个车道的马路。</p>
<h3 id="编码和调制">编码和调制</h3>
<ul>
<li>把信号（数或者模）转换为数字信号，叫编码。</li>
<li>把信号（数或者模）转换为模拟信号，叫调制。</li>
</ul>
<p>上面的抽象成了简单的情况，还是要根据语义判断。</p>
<p>参考了：<a href="https://zhuanlan.zhihu.com/p/601728934" rel="noopener" target="_blank">编码技术（RZ、NRZ、NRZI、曼彻斯特、差分曼彻斯特等）</a></p>
<h4 id="极性不归零电平polar-nrzl">极性不归零电平（Polar NRZL）</h4>
<p>Non-Return-to-Zero level</p>
<ul>
<li>正电平，<code>‾</code>，<code>1</code></li>
<li>负电平，<code>_</code>，<code>0</code></li>
</ul>
<h4 id="极性不归零反转polar-nrzi">极性不归零反转（Polar NRZI）</h4>
<p>Non-return-to-zero inverted</p>
<p>中心不跳变，边界遇 1 跳变（反转）。</p>
<h4 id="极性归零polar-rz">极性归零（Polar RZ）</h4>
<p>Return-to-Zero</p>
<ul>
<li>正脉冲，凸（<code>-‾-</code>），<code>1</code></li>
<li>负脉冲，凹（<code>-_-</code>），<code>0</code></li>
</ul>
<h4 id="曼彻斯特编码">曼彻斯特编码</h4>
<p>中心始终跳变</p>
<ul>
<li>G.E. Thomas Convention：
<ul>
<li>中心向下跳变，<code>‾_</code>，<code>1</code></li>
<li>中心向上跳变，<code>_‾</code>，<code>0</code></li>
<li>简记：<strong>下为 1</strong></li>
</ul></li>
<li>IEEE 802.3 Convention 和上面的定义相反</li>
</ul>
<h4 id="差分曼彻斯特编码">差分曼彻斯特编码</h4>
<p>中心始终跳变</p>
<ul>
<li>G.E. Thomas Convention：
<ul>
<li>左边界无跳变，<code>1</code>
<ul>
<li><code>_|_‾</code></li>
<li><code>‾|‾_</code></li>
</ul></li>
<li>左边界有跳变，<code>0</code>
<ul>
<li><code>_|‾_</code></li>
<li><code>‾|_‾</code></li>
</ul></li>
<li>简记：<strong>左连为 1</strong></li>
</ul></li>
<li>IEEE 802.3 Convention 和上面的定义相反</li>
</ul>
<h4 id="对比">对比</h4>
<p>（如果 <code>#</code> 号没对齐，可以尝试换设备查看）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/><span class="line">10</span><br/><span class="line">11</span><br/></pre></td><td class="code"><pre><span class="line"> 1  1  0  0  1</span><br/><span class="line"></span><br/><span class="line">‾‾‾‾‾‾______‾‾‾    # 极性不归零电平 Polar NRZL</span><br/><span class="line"></span><br/><span class="line">‾‾‾_________‾‾‾    # 极性不归零反转 Polar NRZI</span><br/><span class="line"></span><br/><span class="line">-‾--‾--_--_--‾-    # 极性归零 Polar RZ</span><br/><span class="line"></span><br/><span class="line">‾_|‾_|_‾|_‾|‾_|    # 曼彻斯特编码（G.E. Thomas Convention）</span><br/><span class="line"></span><br/><span class="line">‾_|_‾|_‾|_‾|‾_|    # 差分曼彻斯特编码（G.E. Thomas Convention）</span><br/></pre></td></tr></table></figure>
<h4 id="基带调制">基带调制</h4>
<p>基带信号就是原始的数字信号，把基带信号转换成另一种数字信号就叫基带调制。也叫编码。</p>
<h4 id="带通调制">带通调制</h4>
<p>使用载波的。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/></pre></td><td class="code"><pre><span class="line">‾‾‾‾‾‾______‾‾‾    # 基带信号</span><br/><span class="line"></span><br/><span class="line">MWMWMW------MWM    # 调幅（AM）</span><br/><span class="line"></span><br/><span class="line">MWMWMWПUПUПUMWM    # 调频（FM）</span><br/><span class="line"></span><br/><span class="line">MWMWMWWMWMWMMWM    # 调相（PM）</span><br/></pre></td></tr></table></figure>
<h4 id="正交振幅调制qam">正交振幅调制（QAM）</h4>
<p>简单地理解就是：</p>
<p><span class="math display">\[
\begin{aligned}
调制后的信号 &amp; = 振幅 \times 载波(相位) \\
y &amp; = A\sin(\omega x + \phi) \\
\end{aligned}
\]</span></p>
<p>用不同的<strong>振幅</strong>和<strong>相位</strong>排列组合，来表示（承载）不同的基带信号，比只调幅/只调频/只调相的信息密度高。</p>
<p>使用 <span class="math inline">\(x\)</span> 个振幅和 <span class="math inline">\(y\)</span> 个相位的 QAM 时，一个码元对应的比特数是
<span class="math inline">\(\log _2(xy)\)</span> 向上取整。</p>
<h3 id="通信基础概念">通信基础概念</h3>
<ul>
<li>码元
<ul>
<li><span class="math inline">\(1\)</span> 码元对应 <span class="math inline">\(x \mathrm{bit}\)</span> 时（<span class="math inline">\(x &gt; 1\)</span>）：</li>
<li>码元种类数（信号状态数） <span class="math inline">\(n =
2^x\)</span></li>
<li>码元对应的比特数 <span class="math inline">\(x =
\log_2(n)\)</span></li>
<li>当 <span class="math inline">\(0 &lt; x &lt;
1\)</span>时，一个比特由多个码元表示</li>
</ul></li>
<li>奈氏准则：无噪声低通信道中码元传输最高速率
<ul>
<li><span class="math inline">\(波特 = \mathrm{码元/s} = 2W \times
【码元单位】\)</span></li>
<li><span class="math inline">\(W\)</span>：信道的频域带宽 <span class="math inline">\(\mathrm{Hz}\)</span></li>
<li><span class="math inline">\(比特率 = \mathrm{bit/s} = 2Wx =
2W\log_2(n)\)</span></li>
</ul></li>
<li>信噪比
<ul>
<li>用 <span class="math inline">\(\dfrac{S}{N}\)</span> 表示</li>
<li>用 <span class="math inline">\(\mathrm{dB} = 10 \log_{10}
\dfrac{S}{N}\)</span> 表示</li>
<li><span class="math inline">\(\dfrac{S}{N} =
10^{\mathrm{dB}/10}\)</span></li>
</ul></li>
<li>香农公式：信道极限速率
<ul>
<li><span class="math inline">\(\mathrm{bit/s} = W \log_2 (1 +
\dfrac{S}{N})\)</span></li>
</ul></li>
<li>奈氏准则和香农公式的意义</li>
<li>影响数据在信道中传输速率的因素有：
<ul>
<li>信道长度</li>
<li>信道带宽</li>
<li>信噪比</li>
<li><a href="/blog/CN/03/#编码方式">编码方式</a></li>
<li><a href="/blog/CN/05">信道复用方式</a></li>
<li>信号传播速度（电磁波在介质中的传播速度）<strong>不会影响</strong>信道数据的传输速率</li>
</ul></li>
</ul>
<!--more-->
<h4 id="码元">码元</h4>
<p>码元，就是用来表示【码】的单个【元】。</p>
<ul>
<li>【码】就是串 <code>010100...</code></li>
<li>【元】就是符号（x 元 x 次方程）。</li>
<li>【码元】就是用来表示长串的众多符号中的单个符号。</li>
</ul>
<p>比如串 <code>1001 1111</code>，可以分隔成前后两部分，记作
<code>9F</code>。</p>
<p><code>9</code> 和 <code>F</code>
都是码元，是不同的码元，它们分别一一对应（双射）了一个四位二进制数。</p>
<p>如果分隔成八个部分，那 <code>0</code> 和 <code>1</code>
也是码元。</p>
<p><span class="math inline">\(\{一，壹，Ⅰ，①，...\}\)</span>
都是码元，这是多个码元对应一个比特 <code>1</code> 的情况。</p>
<p>类比信号，码就是波形，码元就是在发送和解读波形时，可以分辨的最小单位波形。</p>
<h4 id="奈氏准则奈奎斯特香农采样定理的一部分">奈氏准则（奈奎斯特—香农采样定理的一部分）</h4>
<p>奈奎斯特这个人推导出的准则：</p>
<p><span class="math display">\[
\begin{aligned}
&amp; 低通信道中码元传输的最高速率（码元/\mathrm{s}） \\
= \ &amp; 两倍频域带宽（\mathrm{单位是 Hz，即 s^{-1}}）\times
【码元单位】
\end{aligned}
\]</span></p>
<p>是在理想的、信道内无噪声的情况下。这里的最高速率指的是，保证接收方接收符号（码元）不出错（码间串扰）时的速率上限。</p>
<p><span class="math inline">\(1\)</span> 码元对应 <span class="math inline">\(x\)</span>
个比特。但这里强调的是“码元每秒”，所以用“码元单位”。</p>
<p>符号速率（码元每秒）也叫波特 <span class="math inline">\(\mathrm{Baud}\)</span>。</p>
<p>频域带宽用 <span class="math inline">\(W\)</span> 表示。</p>
<h4 id="信噪比">信噪比</h4>
<p>就是信比噪，两种表示方式：</p>
<ul>
<li><span class="math inline">\(\dfrac{S}{N} =
\dfrac{信号平均功率}{噪声平均功率}\)</span></li>
<li><span class="math inline">\(\mathrm{dB} = 10
\lg\dfrac{S}{N}\)</span></li>
</ul>
<p>前者没有单位，也可以看成是 <span class="math inline">\(\dfrac{瓦特}{瓦特}\)</span>。</p>
<p>后者是无量纲单位 <span class="math inline">\(\mathrm{dB}\)</span>。（是单位，这里为了方便把它当成物理量用）</p>
<p>第二个式子可以改写成 <span class="math inline">\(\dfrac{S}{N} =
10^{\mathrm{dB}/10}\)</span></p>
<h4 id="香农公式香农哈特莱容量定理">香农公式（香农—哈特莱容量定理）</h4>
<p>考虑到了信道有噪声：</p>
<p><span class="math display">\[
\begin{aligned}
信道极限速率 &amp; = \mathrm{bit/s = Hz \times bit} \\
&amp; = W \log_2(1 + \dfrac{S}{N}) \\
\end{aligned}
\]</span></p>
<p><span class="math inline">\(\mathrm{bit}\)</span>
也是无量纲单位。</p>
<h4 id="奈氏准则和香农公式的意义">奈氏准则和香农公式的意义</h4>
<p>信噪比越大，接收方接收到的信息失真越少。</p>
<p>奈氏准则直接假定噪声为 <span class="math inline">\(0\)</span>，信噪比无穷大。这鼓励了人们研究更好的编码技术，一次传更多的东西。</p>
<p>香农公式告诉我们：</p>
<ul>
<li>信噪比越大，极限速率越高，但是信噪比不可能无限大，所以速率也有极限。</li>
<li>只要信息传输速率低于极限速率，就一定能找到某种方法实现无差错的传输。</li>
</ul>
<p>计算传输速率时，取奈氏准则和香农公式的结果小的。</p>
<h4 id="信道复用">信道复用</h4>
<ul>
<li>频分复用（FDM）</li>
<li>时分复用（TDM）</li>
<li>统计时分复用（STDM）</li>
<li>波分复用（WDM）</li>
<li>码分复用（CDM）</li>
<li>频分多址/时分多址/码分多址（FDMA/TDMA/CDMA）</li>
</ul>
<h4 id="频分复用fdm">频分复用（FDM）</h4>
<ul>
<li>Frequency Division Multiplexing</li>
<li>Frequency：频率</li>
<li>Division：划分</li>
<li>Multiplex：多种的</li>
</ul>
<p>把一个大频带划分成若干个小频带，把不同的信号分别调制到这些小频带里。</p>
<p>比如 A 信号占用 <span class="math inline">\(\mathrm{10-11kHz}\)</span>，B 信号占用 <span class="math inline">\(\mathrm{11-12kHz}\)</span>……把它们一起发出去。</p>
<p>相当于 CPU 多核进程并行。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/><span class="line">10</span><br/><span class="line">11</span><br/></pre></td><td class="code"><pre><span class="line">^频率</span><br/><span class="line">|</span><br/><span class="line">|-----------------</span><br/><span class="line">|C信号</span><br/><span class="line">|-----------------</span><br/><span class="line">|B信号</span><br/><span class="line">|-----------------</span><br/><span class="line">|A信号</span><br/><span class="line">|-----------------</span><br/><span class="line">|</span><br/><span class="line">|-----------------------&gt;时间</span><br/></pre></td></tr></table></figure>
<h4 id="时分复用tdm">时分复用（TDM）</h4>
<ul>
<li>Time Division Multiplexing</li>
</ul>
<p>把时间分割成一个个 TDM
帧，每帧内分为若干个时隙，每个时隙内分别传送不同的信号。</p>
<p>相当于 CPU 单核进程并发。</p>
<p>每个 TDM 帧内保证每组信号都传了，就是没传也要保留留给它的空时隙。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/></pre></td><td class="code"><pre><span class="line">^频率</span><br/><span class="line">|</span><br/><span class="line">|--------------------------</span><br/><span class="line">|A|B|C|A|B|C| |B|C|A| |C|</span><br/><span class="line">|--------------------------</span><br/><span class="line">|     |     |     |     |</span><br/><span class="line">|TDM帧|TDM帧|TDM帧|TDM帧|</span><br/><span class="line">|------------------------------&gt;时间</span><br/></pre></td></tr></table></figure>
<p>这造成信道利用率不高。</p>
<h4 id="统计时分复用stdm">统计时分复用（STDM）</h4>
<ul>
<li>Statistic：统计</li>
</ul>
<p>和 TDM 一样把时间划分成一个个帧。</p>
<p>但在每个 STDM
帧内，时隙数量小于信号种类数量。为每组信号动态分配时隙，比如 B
信号断了可以先不传它。</p>
<p><strong>有四组信号 ABCD：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/><span class="line">10</span><br/><span class="line">11</span><br/></pre></td><td class="code"><pre><span class="line"> ^信号</span><br/><span class="line"> |</span><br/><span class="line"> |--------------------------</span><br/><span class="line">D| d | d | d | d |</span><br/><span class="line"> |--------------------------</span><br/><span class="line">C|   | c | c | c |</span><br/><span class="line"> |--------------------------</span><br/><span class="line">B| b | b |   |   |</span><br/><span class="line"> |--------------------------</span><br/><span class="line">A| a |   | a | a |</span><br/><span class="line"> |------------------------------&gt;时间</span><br/></pre></td></tr></table></figure>
<p><strong>STDM：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/></pre></td><td class="code"><pre><span class="line">^频率</span><br/><span class="line">|</span><br/><span class="line">|--------------------------</span><br/><span class="line">|a|b|d|b|c|d|a|d|c|c|d|a|</span><br/><span class="line">|--------------------------</span><br/><span class="line">|     |     |     |     |</span><br/><span class="line">|STDMf|STDMf|STDMf|STDMf|</span><br/><span class="line">|------------------------------&gt;时间</span><br/></pre></td></tr></table></figure>
<h4 id="波分复用wdm">波分复用（WDM）</h4>
<ul>
<li>Wavelength：波长</li>
</ul>
<p>就是<strong>光的频分复用</strong>，但是用波长表示。</p>
<h4 id="码分复用cdm">码分复用（CDM）</h4>
<ul>
<li>Code：码</li>
</ul>
<p>把一个码元用多个符号表示，每个符号叫<strong>码片</strong>（chip）。</p>
<ul>
<li>比如把 <code>1</code> 用 <code>0001 1011</code> 表示。</li>
<li>那么 <code>0</code> 必须用上面的反码 <code>1110 0100</code>
表示。</li>
</ul>
<p>为了方便，把 <strong>码片</strong> <code>0</code> 记作 <span class="math inline">\(-1\)</span>，<strong>码片</strong> <code>1</code>
记作 <span class="math inline">\(+1\)</span>。那么：</p>
<table>
<thead>
<tr class="header">
<th>码元</th>
<th>码片们</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>1</code></td>
<td><span class="math inline">\((-1,-1,-1,+1,+1,-1,+1,+1)\)</span></td>
</tr>
<tr class="even">
<td><code>0</code></td>
<td><span class="math inline">\((+1,+1,+1,-1,-1,+1,-1,-1)\)</span></td>
</tr>
</tbody>
</table>
<h4 id="频分多址时分多址码分多址fdmatdmacdma">频分多址/时分多址/码分多址（FDMA/TDMA/CDMA）</h4>
<ul>
<li>MA：Multiple Access（多路访问）</li>
</ul>
<p>多址，就是可以让多个用户在不同地点接入进来。</p>
<p>FDM、TDM、CDM 没有强调多不多址。</p>
<h4 id="题目">题目</h4>
<p><strong>14 年考研 37 题</strong></p>
<blockquote>
<p>站点 A、B、C 通过 CDMA 共享链路，A、B、C 的码片序列分别是（1, 1, 1,
1）、（1, -1, 1, -1）和（1, 1, -1, -1），若 C 从链路上收到的序列是（2,
0, 2, 0, 0, -2, 0, -2, 0, 2, 0, 2），则 <strong>C 收到 A</strong>
发送的数据是？</p>
</blockquote>
<p>C 的序列分成四位一组，分别与 A 的序列做规格化内积：</p>
<p><span class="math display">\[
\frac{1}{4} \times
\begin{bmatrix}
2 &amp; 0 &amp; 2 &amp; 0 \\
0 &amp; -2 &amp; 0 &amp; -2 \\
0 &amp; 2 &amp; 0 &amp; 2 \\
\end{bmatrix} A^T =
\begin{bmatrix}
1 \\
-1 \\
1 \\
\end{bmatrix}
\]</span></p>
<p>1 代表 <code>1</code>，-1 代表 <code>0</code>。</p>
<p>所以 C 收到 A 发送的数据是 <code>101</code>。</p>
<p><strong>【2-16】</strong></p>
<p>来自谢老《计算机网络（第 8 版）》</p>
<blockquote>
<p>共有四个站进行码分多址 CDMA 通信。四个站的码片序列为： A: (-1 -1 -1
+1 +1 -1 +1 +1) B: (-1 -1 +1 -1 +1 +1 +1 -1) C: (-1 +1 -1 +1 +1 +1 -1
-1) D: (-1 +1 -1 -1 -1 -1 +1 -1) 现收到这样的码片序列：(-1 +1 -3 +1 -1
-3 +1 +1)。问<strong>哪个站发送数据了</strong>？发送数据的站发送的是 1
还是 0？</p>
</blockquote>
<p>把收到的序列分别与四个站的序列做规格化内积：</p>
<p><span class="math display">\[
\frac{1}{8} \times
\begin{bmatrix}
A \\
B \\
C \\
D \\
\end{bmatrix}
\begin{bmatrix}
-1 \\
+1 \\
-3 \\
+1 \\
-1 \\
-3 \\
+1 \\
+1 \\
\end{bmatrix} =
\begin{bmatrix}
1 \\
-1 \\
0 \\
1 \\
\end{bmatrix}
\]</span></p>
<ul>
<li>A 站发送了<code>1</code></li>
<li>B 站发送了<code>0</code></li>
<li>C 站没有发送</li>
<li>D 站发送了<code>1</code></li>
</ul>
<h2 id="数据链路层">数据链路层</h2>
<p>物理层没法解决的三个问题：</p>
<ol type="1">
<li>发出去之后，哪一方接收</li>
<li>传输何时开始，何时结束</li>
<li>判断是否有传输错误</li>
</ol>
<p>对应数据链路层的三个基本问题：</p>
<ol type="1">
<li>封装成帧（载客）
<ul>
<li>帧定界符 SOH、EOT（何时开始和结束）</li>
</ul></li>
<li>透明传输（转义特殊字符）
<ul>
<li>ESC</li>
</ul></li>
<li>差错检测（判断传输是否出错）
<ul>
<li>误码率（BER）</li>
<li>帧检验序列（FCS）的计算：在待传数据后面加上（<span class="math inline">\(P\)</span> 长度减一/生成多项式最高次数）个
0，然后用 <span class="math inline">\(P\)</span> 去除，得到的余数。</li>
<li>循环冗余检验（CRC）的方法</li>
<li>【无比特差错】与【无传输差错】</li>
</ul></li>
</ol>
<p>数据链路层：物理链路+协议与实现协议的软硬件（马路+交通规则）。</p>
<p>把从物理层收到的比特流封装成帧，上交给网络层。</p>
<p>帧相当于出租车，物理链路相当于马路。</p>
<p>它不考虑物理层是怎么传比特的。</p>
<p>网络适配器（网卡）连接了物理层和数据链路层。</p>
<h3 id="封装成帧">封装成帧</h3>
<p>帧是出租车，数据是乘客。</p>
<p>出租车有载客上限，帧有最大传送单元 MTU（Maximum Transfer Unit）。</p>
<p>如果数据长度超过了 MTU，会被分割成多个帧。</p>
<h4 id="帧定界符">帧定界符</h4>
<p>是帧的一部分，它位于帧的前后，标识帧开始和结束。</p>
<ul>
<li>SOH（Start Of Header）：头部的开始
<ul>
<li>二进制：<code>0000 0001</code></li>
<li>Unicode：<code>U+0001</code></li>
<li>HTML：<code>&amp;#1;</code></li>
<li>键盘：<code>^A</code></li>
</ul></li>
<li>EOT（End Of Transmission）：传输结束
<ul>
<li>二进制：<code>0000 0010</code></li>
<li>Unicode：<code>U+0004</code></li>
<li>HTML：<code>&amp;#4;</code></li>
<li>键盘：<code>^D</code></li>
</ul></li>
</ul>
<p>如果帧数据部分的某一个字节和帧定界符雷同了，为了避免把它当成帧定界符，需要在它前面加上转义字符。</p>
<p>发送端：网络层 -&gt; 数据链路层之前：插入转义字符。</p>
<p>接收端：数据链路层 -&gt; 网络层之前：剔除转义字符。</p>
<h3 id="透明传输">透明传输</h3>
<p>让数据【看不见】数据链路上有什么妨碍它传输的东西。或者说数据链路对数据来说是【透明】的。</p>
<h4 id="转义字符">转义字符</h4>
<ul>
<li>ESC（Escape）：逃
<ul>
<li>二进制：<code>0001 1011</code></li>
<li>Unicode：<code>U+001B</code></li>
<li>HTML：<code>&amp;#27;</code></li>
<li>键盘：<code>^[</code></li>
</ul></li>
</ul>
<p>收到两个连续的转义字符时，说明发送端传了一个转义字符的符号，而不是它的语义。相当于程序设计语言中的<code>\\</code>。</p>
<h3 id="差错检测">差错检测</h3>
<p>判断数据是否传输出错。</p>
<h4 id="误码率ber">误码率（BER）</h4>
<p>Bit Error Rate</p>
<p>平均每传送 <span class="math inline">\(\mathrm{(BER)^{-1}}\)</span>
个比特，会有一个比特出错。</p>
<h4 id="帧检验序列fcs">帧检验序列（FCS）</h4>
<p>Frame Check Sequence</p>
<p>简称冗余码。</p>
<p>冗余码的二进制位数记作 <span class="math inline">\(n\)</span>，这里取
<span class="math inline">\(n = 3\)</span> 的例子：</p>
<ol type="1">
<li><p>明确待传的数据，比如 <code>1001 0001</code>。可记作 <span class="math inline">\(M\)</span>。</p></li>
<li><p>把待传数据后面<strong>补上 <span class="math inline">\(n\)</span>
个 <code>0</code></strong>，比如
<code>1001 0001 000</code>。相当于对它乘了三次二。即 <span class="math inline">\(2^{n}M\)</span> <span class="math inline">\((n =
3)\)</span>，<strong>它是被除数</strong>。</p></li>
<li><p>用双方提前规定好的<strong>除数</strong> <span class="math inline">\(P\)</span> 去除被除数，<span class="math inline">\(P\)</span> 比冗余码的长度多一位。比如
<code>1100</code>：</p>
<p>（空格是分隔符，看得清楚一些，没有特殊含义）</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/></pre></td><td class="code"><pre><span class="line">        1</span><br/><span class="line">    -------------</span><br/><span class="line">1100|1001 0001 000</span><br/><span class="line">     1100</span><br/></pre></td></tr></table></figure>
<p>↑ 不管大小，<code>1</code> 开头就商 <code>1</code>，<code>0</code>
开头就商 <code>0</code>：</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/></pre></td><td class="code"><pre><span class="line">        1</span><br/><span class="line">    --------------</span><br/><span class="line">1100|1001 0001 000</span><br/><span class="line">     1100</span><br/><span class="line">     ------</span><br/><span class="line">      101 0</span><br/></pre></td></tr></table></figure>
<p>↑“相减”，相当于对<strong>后三位</strong>做了<strong>异或</strong>操作（异为
<code>1</code>，同为 <code>0</code>）。</p>
<p>继续操作：</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/><span class="line">10</span><br/><span class="line">11</span><br/><span class="line">12</span><br/><span class="line">13</span><br/><span class="line">14</span><br/><span class="line">15</span><br/><span class="line">16</span><br/><span class="line">17</span><br/><span class="line">18</span><br/><span class="line">19</span><br/><span class="line">20</span><br/><span class="line">21</span><br/><span class="line">22</span><br/><span class="line">23</span><br/><span class="line">24</span><br/><span class="line">25</span><br/><span class="line">26</span><br/><span class="line">27</span><br/></pre></td><td class="code"><pre><span class="line">        1 1100 001</span><br/><span class="line">    --------------</span><br/><span class="line">1100|1001 0001 000</span><br/><span class="line">     1100</span><br/><span class="line">     ------</span><br/><span class="line">      101 0</span><br/><span class="line">      110 0</span><br/><span class="line">      ------</span><br/><span class="line">       11 00</span><br/><span class="line">       11 00</span><br/><span class="line">       ------</span><br/><span class="line">        0 000</span><br/><span class="line">        0 000</span><br/><span class="line">        ------</span><br/><span class="line">          0001</span><br/><span class="line">          0000</span><br/><span class="line">          ------</span><br/><span class="line">           001 0</span><br/><span class="line">           000 0</span><br/><span class="line">           ------</span><br/><span class="line">            01 00</span><br/><span class="line">            00 00</span><br/><span class="line">            ------</span><br/><span class="line">             1 000</span><br/><span class="line">             1 100</span><br/><span class="line">             -----</span><br/><span class="line">               100</span><br/></pre></td></tr></table></figure>
<p>则余数 <code>100</code> 就是冗余码。</p></li>
<li><p>把冗余码添加到原数据的末尾： <code>1001 0001 100</code></p></li>
</ol>
<h4 id="循环冗余检验crc">循环冗余检验（CRC）</h4>
<p>Cyclic Redundancy Check</p>
<p>接收方把收到的、经发送方添加了冗余码后的数据再用 <span class="math inline">\(P\)</span>
去除，如果余数为零，说明有<strong>极大概率</strong>传输没出错；反过来如果传输没出错，则余数<strong>一定</strong>为零。</p>
<p>除数 <span class="math inline">\(P\)</span> 还有一种记法，比如：</p>
<p><code>1100</code> 记作：</p>
<p><span class="math display">\[
X^3+X^2
\]</span></p>
<p><code>101 1001</code> 记作：</p>
<p><span class="math display">\[
X^6+X^4+X^3+1
\]</span></p>
<p>这种多项式被称作【生成多项式】 <span class="math inline">\(P(X)\)</span></p>
<h4 id="无比特差错与无传输差错">无比特差错与无传输差错</h4>
<p>通过添加冗余码和 CRC，能够实现几乎百分百的无比特差错。</p>
<p>——这是对于每一个帧来说的。如果接收方没有收到某一个帧，或者收到了重复的帧，或者收到帧的顺序错了：这三种情况都属于传输差错。</p>
<p>CRC 不保证无传输差错，所以不属于【可靠传输】。</p>
<h3 id="点对点协议ppp">点对点协议PPP</h3>
<ul>
<li>Point-to-Point Protocol：用户到 ISP 的协议。ISP 是学校，PPP
就是和门口保安的对话。<a href="https://www.rfc-editor.org/rfc/rfc1661" rel="noopener" target="_blank">RFC 1661</a> | <a href="https://blog.csdn.net/qq_20677327/article/details/106079040" rel="noopener" target="_blank">翻译</a>
<ul>
<li>不采用序号和确认机制，接收方每收到一个帧就进行 CRC
校验，正确就收下，错误就丢弃。断章取义。</li>
<li>组成部分：
<ul>
<li>【网络层 -&gt; 数据链路层】一个将 IP 数据报封装到串行链路的方法</li>
<li>【物理层 &lt;-&gt; 数据链路层】一个链路控制协议 LCP (Link Control
Protocol)。分配临时 IP 地址。说话。</li>
<li>【数据链路层 &lt;-&gt; 网络层】一套网络控制协议 NCP (Network Control
Protocol)。填表。</li>
</ul></li>
<li>是有连接，面向字节的协议</li>
</ul></li>
</ul>
<h4 id="ppp-协议的工作状态">PPP 协议的工作状态</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/><span class="line">10</span><br/><span class="line">11</span><br/><span class="line">12</span><br/><span class="line">13</span><br/><span class="line">14</span><br/></pre></td><td class="code"><pre><span class="line">【链路静止】：保安没看见你</span><br/><span class="line">| 猫呼叫路由器，建立物理层连接：和保安搭话</span><br/><span class="line">v</span><br/><span class="line">【链路建立】：保安听见你了，问你来干什么</span><br/><span class="line">| LCP配置协商：我要进学校</span><br/><span class="line">| 失败：保安听不懂你的广东话，【链路静止】</span><br/><span class="line">v</span><br/><span class="line">【鉴别】：验证你的身份</span><br/><span class="line">| 失败：【链路终止】-&gt;【链路静止】</span><br/><span class="line">v</span><br/><span class="line">【网络层协议】：登记</span><br/><span class="line">| NCP配置协商：填表</span><br/><span class="line">v</span><br/><span class="line">【链路打开】：让你进了</span><br/></pre></td></tr></table></figure>
<h4 id="ppp-帧格式">PPP 帧格式</h4>
<table style="width:100%;">
<colgroup>
<col style="width: 14%"/>
<col style="width: 18%"/>
<col style="width: 53%"/>
<col style="width: 7%"/>
<col style="width: 1%"/>
<col style="width: 5%"/>
</colgroup>
<thead>
<tr class="header">
<th>字段名</th>
<th>标志字段、地址字段、控制字段</th>
<th>协议字段</th>
<th>信息字段</th>
<th>FCS</th>
<th>标志字段</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>字段值（十六进制）</strong></td>
<td>7E FF 03</td>
<td>0021【IP
数据报】<br>8021【NCP】<br>C021【LCP】<br>C023【PAP】<br>C223【CHAP】</br></br></br></br></td>
<td>...</td>
<td>...</td>
<td>7E</td>
</tr>
<tr class="even">
<td><strong>字节数（十进制）</strong></td>
<td>3</td>
<td>2</td>
<td>&lt;=MTU(1500)</td>
<td>2</td>
<td>1</td>
</tr>
</tbody>
</table>
<h4 id="异步传输时的字节填充">异步传输时的字节填充</h4>
<p>下面的都是十六进制</p>
<p>转义字符：7D</p>
<table>
<thead>
<tr class="header">
<th>转义前</th>
<th>转义后</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>7E</td>
<td>7D 5E（减了 20）</td>
</tr>
<tr class="even">
<td>7D</td>
<td>7D 5D（减了 20）</td>
</tr>
<tr class="odd">
<td>00 ~ 1F</td>
<td>7D 20 ~ 7D 3F （加了 20）</td>
</tr>
</tbody>
</table>
<p>上面都是对 <code>0x20</code>
做异或，或者说对从低到高第六位取反。<code>0x20</code> 是
<code>0010 0000</code>。</p>
<h4 id="同步传输时的零比特填充">同步传输时的零比特填充</h4>
<p>发现有五个连续 <code>1</code>，就填入一个
<code>0</code>。这样不会出现六个连续 <code>1</code>。</p>
<p>因为不是按字节传输的，是按比特传输的，为了规避定界符
<code>0x7E</code> 的 <code>0111 1110</code>。</p>
<h4 id="另外">另外</h4>
<p>HDLC 也是数据链路层的协议，是面向比特的协议，使用零比特填充。</p>
<h3 id="csmacd-协议">CSMA／CD 协议</h3>
<ul>
<li>CSMA/CD：Carrier Sense Multiple Access with Collision
Detection，载波监听多址接入/碰撞检测协议。以太网用的。
<ul>
<li>使用曼彻斯特编码（中心始终跳变，01
为跳变方向不同），频带宽度比基带信号增加一倍。</li>
<li>多点接入：多台计算机连在一根总线上：多个人在同一个房间。</li>
<li>载波（载体）监听：每个站都不停地检测信道：在说话前和说话中听别人有没有说话。</li>
<li>碰撞检测：检测信号电压：听到了自己和其他人同时说话的声音。</li>
<li>一个站不能同时发送和接收：人不能同时（并行）听懂和说明白。半双工（双向交替通信）。</li>
<li>是无连接的协议：一群人头脑风暴。</li>
<li>碰撞的过程。</li>
<li>计算碰撞后重传的等待时间：截断二进制指数退避。用 r 乘争用期。</li>
</ul></li>
<li><a href="/blog/CN/09">以太网</a>
<ul>
<li>以太网的信道利用率</li>
<li>争用期规定为 <span class="math inline">\(51.2 \mathrm{\mu
s}\)</span>，如果在这段时间内没有检测到碰撞，后续就不会碰撞。</li>
<li>帧间最小间隔为 <span class="math inline">\(9.6 \mathrm{\mu
s}\)</span></li>
<li>最短帧长 = 争用期 × 带宽。</li>
</ul></li>
</ul>
<h4 id="名词辨析csma-与-cdma">名词辨析：CSMA 与 CDMA</h4>
<p>CS 是载波监听（Carrier Sense），CD 是码分（Code Division），MA
都是多址接入（Multiple Access）。</p>
<p>后者是码分多址复用。</p>
<p>而 CSMA/CD 的 CD 是碰撞检测（Collision Detection）。</p>
<p>CSMA/CD 用于有线网，还有一个 CSMA/CA（Collision
Avoidance，碰撞避免），用于无线网。</p>
<h4 id="csmacd-协议工作流程">CSMA/CD 协议工作流程</h4>
<p>听到有别人正在说话时，自己不说话。</p>
<p>没人正在说话时，自己说话，说话过程中听到有别人说了就不说，等一段时间后再准备说。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/><span class="line">10</span><br/><span class="line">11</span><br/><span class="line">12</span><br/><span class="line">13</span><br/><span class="line">14</span><br/></pre></td><td class="code"><pre><span class="line">准备发送 -&gt; 载波监听&lt;------</span><br/><span class="line">   ^           |         ^</span><br/><span class="line">   |           v         |</span><br/><span class="line">   |       监听到了 -&gt; 准备发送</span><br/><span class="line">   |       没监听到 -&gt; 发送，同时开始碰撞检测</span><br/><span class="line">   |                           |</span><br/><span class="line">等待随机时间（截二退）           |</span><br/><span class="line">   ^                           |</span><br/><span class="line">   |                           |</span><br/><span class="line">发送人为干扰信号                |</span><br/><span class="line">   ^                           |</span><br/><span class="line">   |                           v</span><br/><span class="line">停止发送&lt;-------------------检测到了</span><br/><span class="line">                           没检测到就发送直到完成</span><br/></pre></td></tr></table></figure>
<h4 id="碰撞">碰撞</h4>
<p>单程端到端传播时延（从【说出口】到【被人听到】经历的时间）记为 <span class="math inline">\(\tau\)</span>。为方便看，这里 <span class="math inline">\(\tau = 20\)</span>。</p>
<p>B 在 <span class="math inline">\(\tau - \delta\)</span> 时刻向 A
发送，过程中检测到了碰撞。这里 <span class="math inline">\(\delta =
5\)</span>。</p>
<p>这里碰撞的时刻是 <span class="math inline">\(17.25\)</span>，即 <span class="math inline">\(\tau - \delta / 2\)</span>。</p>
<pre class="mermaid">gantt
    title 碰撞（甘特图）
    dateFormat s
    axisFormat %S

    section 传播过程
    A发送后，从A到B传播          :0,20s
    B发送后，从B到A传播          :15,20s
    B检测到了碰撞，然后……          :20,36s
    A检测到了碰撞，然后……          :35,21s</pre>
<p>A 或 B 发送之后，至多需要 <span class="math inline">\(2 \tau\)</span>
的时间，即端到端往返时延，才能检测到与对方发生了碰撞。</p>
<p><span class="math inline">\(2 \tau\)</span>
叫【争用期】或【碰撞窗口】。</p>
<p><span class="math inline">\(2 \tau\)</span> 规定为 <span class="math inline">\(51.2 \mathrm{\mu s}\)</span>。</p>
<h4 id="强化碰撞">强化碰撞</h4>
<p>碰撞之后，除了停止发送数据，还要发送 32 比特或 48
比特的人为干扰信号，告诉所有用户已经发送了碰撞。</p>
<h4 id="截断二进制指数退避">截断二进制指数退避</h4>
<p>计算碰撞后重传的等待时间。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br/><span class="line">2</span><br/><span class="line">3</span><br/><span class="line">4</span><br/><span class="line">5</span><br/><span class="line">6</span><br/><span class="line">7</span><br/><span class="line">8</span><br/><span class="line">9</span><br/><span class="line">10</span><br/><span class="line">11</span><br/></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br/><span class="line"></span><br/><span class="line">tau = <span class="number">25.6</span>  <span class="comment"># 单程时延</span></span><br/><span class="line">basic_backoff_time = <span class="number">2</span> * tau  <span class="comment"># 往返时延，基本退避时间</span></span><br/><span class="line"></span><br/><span class="line"></span><br/><span class="line"><span class="keyword">for</span> retransmit_count <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">17</span>):</span><br/><span class="line">    <span class="built_in">print</span>(<span class="string">f"第<span class="subst">{retransmit_count}</span>次重传"</span>)</span><br/><span class="line">    k = <span class="built_in">min</span>(retransmit_count, <span class="number">10</span>)</span><br/><span class="line">    r = random.randint(<span class="number">0</span>, <span class="number">2</span>**k - <span class="number">1</span>)</span><br/><span class="line">    <span class="built_in">print</span>(<span class="string">f"退避时间：<span class="subst">{r*basic_backoff_time}</span>"</span>)</span><br/></pre></td></tr></table></figure>
<p>重传 16 次仍不成功就丢弃，并向高层报告。</p>
<h3 id="以太网的信道利用率">以太网的信道利用率</h3>
<p>帧的发送时间 <span class="math inline">\(T_0\)</span>：</p>
<p><span class="math display">\[
\mathrm{s = \frac{bit}{bit/s} = } \frac{L}{C} =
\frac{帧长}{数据发送速率}
\]</span></p>
<p>拖一会。</p>
<h3 id="例题">例题</h3>
<h4 id="section">【3-24】</h4>
<blockquote>
<p>假定站点 A 和 B 在同一个 10 Mbit/s
以太网网段上。这两个站点之间的传播时延为 225 比特时间。现假定 A
开始发送一帧，并且在 A 发送结束之前 B 也发送一帧。如果 A
发送的是以太网所容许的最短的帧，那么 <strong>A 在检测到和 B
发生碰撞之前能否把自己的数据发送完毕？</strong> 换言之，如果 A
在发送完毕之前并没有检测到碰撞，那么能否肯定 A 所发送的帧不会和 B
发送的帧发生碰撞？（提示：在计算时应当考虑到每一个以太网帧在发送到信道上时，在
MAC 帧前面还要增加若干字节（8 字节，64
比特）的前同步码和帧定界符。）</p>
</blockquote>
<p>即比较【假定 A 发送完】的时刻与【A 检测到碰撞】的时刻谁在前。</p>
<p>这里【A 检测到碰撞】的时刻要取最晚的情况，即 B “即将” 接收到 A
发送的时刻。传播时延是 225 比特时间，如果在 225 时刻 B 还没发送，B
就会接收到 A 发送的，这时 B 就不会发送，进而不会发生碰撞。</p>
<p>所以要取 B 在 224 时刻开始发送。经过一个传播时延，A 在 224 + 225 =
449 时刻检测到碰撞。</p>
<p>假定 A 会发送完：</p>
<p>51.2 μs × 10 Mbit/s = 512 bit</p>
<p>512 + 64 = 576 bit</p>
<p>假定不会发生碰撞，A 将在 576 比特时刻发送完。但是 A 已经在 449
时刻检测到碰撞了，所以 A 不会发送完。</p>
<h4 id="section-1">【3-25】</h4>
<blockquote>
<p>上题中的站点 A 和 B 在 t = 0 时同时发送了数据帧。当 t = 225
比特时间，A 和 B 同时检测到发生了碰撞，并且在 t = 225 + 48 = 273
比特时间完成了干扰信号的传输。A 和 B 在 CSMA/CD 算法中选择不同的 r
值退避。假定 A 和 B 选择的随机数分别是 rA = 0 和 rB = 1。试问 A 和 B
各在什么时间开始重传其数据帧？ A 重传的数据帧在什么时间到达 B？ A
重传的数据会不会和 B 重传的数据再次发生碰撞？B
会不会在预定的重传时间停止发送数据？</p>
</blockquote>
<p>A 或 B 在检测到碰撞之后，需要做以下几件事：</p>
<ol type="1">
<li>发送 48 比特的干扰信号</li>
<li>退避等待一段时间（r × 争用期 51.2 μs）</li>
<li>开始检测信道</li>
<li>检测到空闲后，再等待一个帧最小间隔 9.6 μs</li>
<li>期间没有接收到信号，则重传</li>
</ol>
<p>下面的单位都是比特时间：</p>
<ul>
<li>0 ~ 225：A 和 B 发送的数据在信道上传播</li>
<li>225：A 和 B 同时检测到碰撞</li>
<li>225 ~ 273：A 和 B 都发送干扰信号</li>
<li>273：A 和 B 都发送完了干扰信号，开始退避等待
<ul>
<li>273：A 退避时间为 0，开始检测信道</li>
<li>273 ~ 785：B 退避时间为 512</li>
</ul></li>
<li>225|273 ~ 450|498：干扰信号在信道上传播</li>
<li>450：A 和 B 都接收到了干扰信号</li>
<li>498：A 和 B 都接收完了干扰信号，B 仍然在退避
<ul>
<li>498 ~ 594：A 检测到空闲，等待 96</li>
<li>594：A 开始重传</li>
<li>594 ~ 819：A 重传的数据在信道上传播</li>
</ul></li>
<li>785：B 开始检测信道
<ul>
<li>785 ~ 881：B 等待 96</li>
<li>但是在 819 时间 B 接收到了 A 重传的，所以 B 暂时不重传</li>
</ul></li>
</ul>
<blockquote>
<p>试问 A 和 B 各在什么时间开始重传其数据帧？</p>
</blockquote>
<p>A 在 594，B 不知道</p>
<blockquote>
<p>A 重传的数据帧在什么时间到达 B？</p>
</blockquote>
<p>819</p>
<blockquote>
<p>A 重传的数据会不会和 B 重传的数据再次发生碰撞？</p>
</blockquote>
<p>不会</p>
<blockquote>
<p>B 会不会在预定的重传时间停止发送数据？</p>
</blockquote>
<p>会</p>
<h3 id="以太网">以太网</h3>
<ul>
<li>以太网：Ethernet，是一种局域网技术（可以作为局域网的同义词），使用
CSMA/CD 协议。
<ul>
<li>DIX Ethernet V2：第一个局域网标准。现在主要用这个。</li>
<li>IEEE 802.3：第一个 IEEE 的局域网标准。</li>
</ul></li>
<li>局域网共享信道，为避免冲突，可采用静态划分信道（复用）或动态媒体接入控制（多点接入：随机接入/受控接入-轮询）</li>
<li>局域网数据链路层的两个子层：
<ul>
<li>逻辑链路控制 LLC (Logical Link Control)
子层：与传输媒体无关。已经很少用了。</li>
<li>媒体接入控制 MAC (Medium Access Control) 子层：与传输媒体有关。</li>
</ul></li>
<li>MAC 帧的格式
<ul>
<li>（带宽为 <span class="math inline">\(\mathrm{10Mbit/s}\)</span>
的）以太网 V2： <span class="math display">\[
6 + 6 + 2 + (46 \sim 1500) + 4 = (64 \sim 1518) 字节
\]</span> 其中 <span class="math inline">\(\mathrm{64Byte = \dfrac{51.2
\mu s \times 10Mbit/s}{8bit/Byte}}\)</span>，减去 18
字节的首部和尾部后，得到数据部分的最小长度 46 字节。</li>
</ul></li>
<li>集线器（Hub）与交换机（Switch）
<ul>
<li>某某带宽的集线器：分摊带宽。总线型。</li>
<li>某某带宽的交换机：每个接口独占带宽。并行。</li>
</ul></li>
<li>以太网交换机的自学习功能</li>
<li>适配器的作用：
<ul>
<li>与 CPU/存储器并行通信</li>
<li>与局域网串行通信</li>
<li>接收并缓存 MAC
帧，帧的目标地址不是它自己时，或者不符合格式、校验失败时就丢弃</li>
<li>安装驱动到操作系统</li>
<li>实现以太网协议</li>
</ul></li>
</ul>
<!--more-->
<h3 id="windows-下用-cmd-查看网络适配器的-mac-地址">Windows 下用 cmd
查看网络适配器的 MAC 地址</h3>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br/></pre></td><td class="code"><pre><span class="line"><span class="built_in">ipconfig</span> /all</span><br/></pre></td></tr></table></figure>
<p>适配器的 MAC
地址又叫硬件地址/物理地址。一台计算机可以有多个适配器。</p>
<h3 id="mac-地址">MAC 地址</h3>
<p><a href="https://standards.ieee.org/wp-content/uploads/import/documents/tutorials/eui.pdf" rel="noopener" target="_blank">EUI</a>-48：</p>
<ul>
<li>前三个字节是 IEEE 的注册管理机构分配的</li>
<li>后三个字节是厂家自行分配的</li>
<li>第一个字节最低位：0 为单播，1 为多播</li>
<li>全 1 的地址（FF:FF:FF:FF:FF:FF）是广播地址</li>
</ul>
<h3 id="以太网-v2-的-mac-帧格式">以太网 V2 的 MAC 帧格式</h3>
<table>
<colgroup>
<col style="width: 9%"/>
<col style="width: 16%"/>
<col style="width: 16%"/>
<col style="width: 47%"/>
<col style="width: 6%"/>
<col style="width: 2%"/>
</colgroup>
<thead>
<tr class="header">
<th><strong>字段名</strong></th>
<th>目标地址</th>
<th>源地址</th>
<th>类型（上一层用的什么协议）</th>
<th>数据</th>
<th>FCS</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>字节数</strong></td>
<td>6</td>
<td>6</td>
<td>2</td>
<td>46~1500</td>
<td>4</td>
</tr>
<tr class="even">
<td><strong>值</strong></td>
<td>xx:xx:xx:xx:xx:xx</td>
<td>xx:xx:xx:xx:xx:xx</td>
<td>0800【IPv4 数据报】<br>80DD【IPv6 数据报】<br/></br></td>
<td>……</td>
<td>……</td>
</tr>
</tbody>
</table>
<p>数据部分不足 46 字节时，补到 46 字节。</p>
<p>MAC 子层 -&gt; 物理层：在 MAC 帧前面插入 7 字节的前同步码和 1
字节的帧定界符：</p>
<p>就是 <code>10101010 10101010 ... 10101010 10101011</code>。交替的 10
用于时钟同步，最后一个字节的最后一个比特变了，告诉接收端，后面的就是 MAC
帧。</p>
<p>不用标记帧结束，因为是曼彻斯特编码，一直在跳变，脱离原本的规律了就是帧结束了。</p>
<h3 id="集线器与交换机">集线器与交换机</h3>
<p>集线器工作在物理层</p>
<p>交换机工作在数据链路层，全双工。并且不使用 CSMA/CD
协议，但仍然使用以太网的帧结构。</p>
<p>交换机的每一个接口都是一个冲突域。</p>
<p>交换机分为直通交换和存储转发。直通交换不校验 FCS，直接读 6
字节的目标地址（有时包含前导码）。</p>
<h3 id="以太网交换机的自学习功能">以太网交换机的自学习功能</h3>
<p>一些机器连在交换机的不同端口上。</p>
<p>源机器发送帧到目标机器，通过交换机。</p>
<p>如果交换机的交换表里没有记录【源机器】的信息（MAC 地址 +
端口），就记录下来。</p>
<p>如果交换机的交换表里没有记录【目标机器】的信息（MAC 地址 +
端口），就向所有机器广播。但是广播后是不记录目标机器的信息的。</p>
<p>记录一个新信息时，同时加上了有效时间，过期的信息会被删除。每查到一次目标地址，会更新有效时间。</p>
<p>广播过程中可能会兜圈子。IEEE 802.1D
标准指定了一个生成树协议（STP），在逻辑上切断一些回路，避免了兜圈子的问题。</p>
<h3 id="base-t-以太网">100BASE-T 以太网</h3>
<ul>
<li>使用双绞线（T），带宽为 100Mbit/s。</li>
<li>标准是 IEEE 802.3u，半双工时使用 CSMA/CD 协议，全双工时不使用。</li>
<li>争用期为 5.12 μs，帧最小间隔 0.96 μs，是 10 Mbit/s
以太网的十分之一。</li>
</ul>
<h2 id="网络层">网络层</h2>
<h3 id="两种服务">两种服务</h3>
<p>网络层应该向运输层提供怎样的服务？面向连接的还是无连接的？</p>
<p>可靠交付应该由谁来完成？是网络还是端系统？</p>
<ul>
<li>虚电路服务：面向连接的，可靠通信由网络来保证</li>
<li>数据报服务：无连接的，可靠通信由用户主机保证</li>
</ul>
<p>现在用数据报服务。</p>
<h3 id="两个层面">两个层面</h3>
<p>在路由器之间有两类传送的信息：分组数据和路由数据。</p>
<p>于是把网络层抽象地划分为“数据层面”和“控制层面”。</p>
<p>在数据层面（或者说转发层面），每个路由器独立地通过本机的转发表转发分组。在控制层面，多个路由器协同动作创建路由表。</p>
<h3 id="路由表和转发表">路由表和转发表</h3>
<h3 id="ipv4">IPv4</h3>
<p>4 个字节，32 个二进制位。</p>
<p>快速计算单字节：</p>
<ul>
<li>从高到低：128 64 32 16 8 4 2 1</li>
<li>高一位/两位/三位/四位一：128 192 224 240</li>
<li>高五位/六位/七位一：248 252 254</li>
<li>全一：255</li>
</ul>
<h3 id="分类编址">分类编址</h3>
<ul>
<li>A 类：网络号 1 个字节，主机号 3 个字节，<code>0</code> 开头</li>
<li>B 类：网络号 2 个字节，主机号 2 个字节，<code>10</code> 开头</li>
<li>C 类：网络号 3 个字节，主机号 1 个字节，<code>110</code> 开头</li>
<li>D 类：多播地址，<code>1110</code> 开头</li>
<li>E 类：保留使用，<code>1111</code> 开头</li>
</ul>
<p>点分十进制表示最高字节的范围：</p>
<ul>
<li>A 类：0 - 127</li>
<li>B 类：128 - 191</li>
<li>C 类：192 - 223</li>
<li>D 类：224 - 239</li>
<li>E 类：240 - 255</li>
</ul>
<p>主机号全零为网络地址。网络号和主机号都全零为默认路由。</p>
<h3 id="无分类编址-cidr">无分类编址 CIDR</h3>
<p>IP 地址与子网掩码做按位与运算。</p>
<p>子网掩码类似 <code>255.248.0.0</code>
（<code>11111111 11111000 00000000 00000000</code>）</p>
<p>与 IP 地址长度相同。前面全是 <code>1</code> 后面全是
<code>0</code>，用于标记 IP 地址用前面的几位表示网络地址。</p>
<p>此例子有 13 个 <code>1</code>，即网络前缀长度是 13，用前面 13
位表示网络地址，后面的位表示主机地址。记作 <code>IP地址/13</code>。</p>
<p>CIDR 编址又叫【构造超网】（相对于子网来说）</p>
<h3 id="ip-地址和-mac-地址">IP 地址和 MAC 地址</h3>
<p>IP 地址相当于工作单位的地址，MAC 地址相当于身份证号。</p>
<ul>
<li>运输层：TCP 报文的首部为端口号。再加一个首部信息，传给网络层</li>
<li>网络层：IP 数据报的首部为 IP
地址。再加一个首部信息、一个尾部信息，传给数据链路层</li>
<li>数据链路层：MAC 帧的首部为 MAC
地址（源和目标）+协议类型【6+6+2】，尾部为
FCS【4】，数据部分【46~1500】</li>
</ul>
</div>
<footer class="post-footer">
<div class="post-nav">
<div class="post-nav-item">
<a href="/blog/mongodb.html" rel="prev" title="MongoDB">
<i class="fa fa-chevron-left"></i> MongoDB
                </a>
</div>
<div class="post-nav-item">
<a href="/blog/gimp-make-words-on-the-photographed-paper-clearer.html" rel="next" title="用 GIMP 让拍摄的纸上的字更清晰">
                  用 GIMP 让拍摄的纸上的字更清晰 <i class="fa fa-chevron-right"></i>
</a>
</div>
</div>
</footer>
</article>
</div>
</div>
</main>
<footer class="footer">
<div class="footer-inner">
<div class="copyright">
  2023 – 
  <span itemprop="copyrightYear">2024</span>
<span class="with-love">
<i class="fa fa-heart"></i>
</span>
<span class="author" itemprop="copyrightHolder">Ruofan</span>
</div>
</div>
</footer>
<div aria-label="返回顶部" class="back-to-top" role="button">
<i class="fa fa-arrow-up fa-lg"></i>
<span>0%</span>
</div>
<div class="reading-progress-bar"></div>
<noscript>
<div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>
<script crossorigin="anonymous" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
<script crossorigin="anonymous" integrity="sha256-j+yj56cdEY2CwkVtGyz18fNybFGpMGJ8JxG3GSyO2+I=" src="https://cdnjs.cloudflare.com/ajax/libs/pangu/4.0.7/pangu.min.js"></script>
<script src="/blog/js/comments.js"></script><script src="/blog/js/utils.js"></script><script src="/blog/js/next-boot.js"></script>
<script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"default","dark":"dark"},"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/9.4.3/mermaid.min.js","integrity":"sha256-e0o3JYsdjqKajf9eOe22FhioYSz9WofRY4dLKo3F6do="}}</script>
<script src="/blog/js/third-party/tags/mermaid.js"></script>
<script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/blog/js/third-party/math/mathjax.js"></script>
<script crossorigin="anonymous" integrity="sha256-yvJQOINiH9fWemHn0vCA5lsHWJaHs6/ZmO+1Ft04SvM=" src="https://cdnjs.cloudflare.com/ajax/libs/quicklink/2.3.0/quicklink.umd.js"></script>
<script class="next-config" data-name="quicklink" type="application/json">{"enable":true,"home":true,"archive":false,"delay":true,"timeout":3000,"priority":true,"url":"https://hrfis.me/blog/computer-network.html"}</script>
<script src="/blog/js/third-party/quicklink.js"></script>
</body>
</html>
